if (self.CavalryLogger) { CavalryLogger.start_js(["CP8gq"]); }

__d("MUFICommentTypingSubscriptionController",["SubscriptionsHandler","UFITypingSubscription","destroyOnUnload"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=15*1e3;function k(a){return{friendCount:m(a),otherCount:n(a)}}function l(a){if(a){a=parseInt(a,10);return!isNaN(a)&&isFinite(a)?a:0}else return 0}function m(a){a=a&&a.feedback_typing_subscribe&&a.feedback_typing_subscribe.feedback&&a.feedback_typing_subscribe.feedback.feedback_typers&&a.feedback_typing_subscribe.feedback.feedback_typers.friend_count;return l(a)}function n(a){a=a&&a.feedback_typing_subscribe&&a.feedback_typing_subscribe.feedback&&a.feedback_typing_subscribe.feedback.feedback_typers&&a.feedback_typing_subscribe.feedback.feedback_typers.other_count;return l(a)}function a(a,b){this.$1=null;this.$2=null;this.$3=b;this.$4=new g();b=h.subscribe(a,function(a){this.$6(a),this.$7()}.bind(this));b&&this.$4.addSubscriptions(b);this.$5=!!b;i(this.destroy.bind(this))}a.prototype.destroy=function(){this.$8(),this.$4.release()};a.prototype.unsubscribe=function(){this.destroy()};a.prototype.didSubscribe=function(){return this.$5};a.prototype.$7=function(){this.$3(k(this.$1))};a.prototype.$8=function(){this.$2&&clearTimeout(this.$2),this.$2=null,this.$1=null};a.prototype.$6=function(a){this.$8(),this.$1=a,this.$2=setTimeout(function(){this.$8(),this.$7()}.bind(this),j)};e.exports=a}),null);