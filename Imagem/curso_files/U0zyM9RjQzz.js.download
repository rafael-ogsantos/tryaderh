if (self.CavalryLogger) { CavalryLogger.start_js(["EkoDm"]); }

__d("MAudioStringUtils",["fbt"],(function(a,b,c,d,e,f,g){"use strict";var h=60;function a(a){a=Math.floor(a);var b=Math.floor(a/h);a=a-b*h;a<10&&(a="0"+a);return g._("{minutes}:{seconds}",[g._param("minutes",b),g._param("seconds",a)])}e.exports={secondsToString:a}}),null);
__d("MAudioPost.react",["ix","DOM","Image.react","MAudioStringUtils","React","asset","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";__p&&__p();var n,o=j.secondsToString;b=babelHelpers.inherits(a,k.Component);n=b&&b.prototype;function a(a){n.constructor.call(this,a),this.state={playing:!1,duration:0,currentTime:0},this.audio=document.createElement("audio"),this.audio.src=this.props.videoSource,this.audio.oncanplaythrough=function(){h.hide(this.props.spinner),this.setState(function(b,a){return{duration:this.audio.duration}}.bind(this))}.bind(this),this.audio.onended=function(){clearInterval(this.timeInterval),this.setState(function(b,a){return{playing:!1}})}.bind(this),this.audio.onplay=function(){this.audio.pause(),this.audio.currentTime=0,this.audio.onplay=null}.bind(this),this.audio.play()}a.prototype.$1=function(){clearInterval(this.timeInterval),this.setState(function(a,b){this.audio.pause();return{playing:!1}}.bind(this))};a.prototype.$2=function(){this.timeInterval=setInterval(function(){this.setState(function(a,b){return{currentTime:this.audio.currentTime}}.bind(this))}.bind(this),200),this.setState(function(a,b){this.audio.play();return{playing:!0}}.bind(this))};a.prototype.render=function(){return k.createElement("div",{className:"_6n4h",style:this.state.duration===0?{display:"none"}:{}},this.state.playing?k.createElement(i,{src:g("636290"),onClick:function(){return this.$1()}.bind(this),className:"_6n4i"}):k.createElement(i,{src:g("551458"),onClick:function(){return this.$2()}.bind(this),className:"_6n4i"}),k.createElement("div",{className:"_6n4j"},k.createElement("span",{className:this.state.playing?"_6n1s":""},o(this.state.currentTime)),"/",o(this.state.duration)))};e.exports=a}),null);
__d("MCommentStatusLogger",["BanzaiLogger","ex","uuid"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=Object.freeze({INIT:"init",SUBMIT:"submit",RESPOND:"respond",RENDER:"render"});function a(a,b,c){this.prevEventType=a||null,this.perfLoggable=!!b,this.isEndStep=!!c}var k={};k[j.INIT]=new a();k[j.SUBMIT]=new a(j.INIT,!0);k[j.RESPOND]=new a(j.SUBMIT,!0);k[j.RENDER]=new a(j.RESPOND,!0,!0);function l(a){this.$1=a,this.$2={},this.$3=0,this.$4=0,this.$5=null}l.prototype.$6=function(a){return a in this.$2};l.prototype.logEvent=function(a,b){__p&&__p();if(this.$6(a)||!(a in k))return!1;var c=k[a],d=c.prevEventType;if(d&&!this.$6(d))return!1;this.$3=b&&Object.prototype.hasOwnProperty.call(b,"text")?b.text:this.$3;this.$4=b&&Object.prototype.hasOwnProperty.call(b,"photo")?b.photo:this.$4;this.$5=(b&&Object.prototype.hasOwnProperty.call(b,"stickerID")?b.stickerID:this.$5)||null;b=Date.now();var e=Math.round(b/1e3);this.$2[a]=b;b={event:a,text_length:this.$3,num_photos:this.$4,sticker_id:this.$5,interaction_key:this.$1,client_time:e};if(d&&c.perfLoggable){e=this.$7(d,a);b=babelHelpers["extends"]({duration:e},b)}g.create({retry:!0}).log("MCommentWriteWaterfallLoggerConfig",b);return!0};l.prototype.$7=function(a,b){var c=this.$2;if(!this.$6(a)||!this.$6(b))return null;a=c[a];c=c[b];return a>c?null:c-a};var m={};b={newInteractionKey:function(){return i()},_logCommentStatus:function(a,b,c){__p&&__p();if(!(b in k))return;var d=m[a];if(b===j.INIT)if(d)return;else d=new l(a),m[a]=d;if(!d)return;d=d.logEvent(b,c);d&&k[b].isEndStep&&this.clear(a)},logInitText:function(a){this._logCommentStatus(a,j.INIT,{text:1})},logInitPhoto:function(a){this._logCommentStatus(a,j.INIT,{photo:1})},logSubmit:function(a,b){this._logCommentStatus(a,j.SUBMIT,{text:b.text,photo:b.photo,stickerID:null})},logReceiveResponse:function(a,b){this._logCommentStatus(a,j.RESPOND,{text:b.text,photo:b.photo,stickerID:b.stickerID})},logRender:function(a){this._logCommentStatus(a,j.RENDER)},logInitAndSubmitSticker:function(a,b){this._logCommentStatus(a,j.INIT,{text:0,photo:0,stickerID:b}),this._logCommentStatus(a,j.SUBMIT,{text:0,photo:0,stickerID:b})},clear:function(a){a in m&&delete m[a]}};e.exports=b}),null);
__d("MProgressBar.react",["MAnimator","React","cx","joinClasses"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k;b=babelHelpers.inherits(a,h.Component);k=b&&b.prototype;function a(a){k.constructor.call(this,a),this.$1=!1,this.state={value:this.props.initialValue},this.setValue=function(a){this.$1&&this.setState({value:a})}.bind(this)}a.prototype.componentDidMount=function(){this.$1=!0};a.prototype.componentWillUnmount=function(){this.$2&&this.$2.dispose(),this.$1=!1};a.prototype.$3=function(a){var b=this.props;a=Math.min(Math.max((a-b.min)/(b.max-b.min)*100,0),100);return a};a.prototype.$4=function(){var a=this.$3(this.state.value),b=Math.round(a);b="fill"+(b===0?" empty":"")+(b===100?" full":"");return h.createElement("div",{className:b,style:{width:a+"%"}})};a.prototype.animate=function(a,b){var c=this.$3(this.state.value);a=this.$3(a);this.$2&&this.$2.dispose();this.$2=g.play(c,a,b,this.setValue)};a.prototype.render=function(){return h.createElement("div",{className:j(this.props.className,"_lbu")},this.$4())};a.defaultProps={min:0,max:100};e.exports=a}),null);
__d("MComposerBackgroundUploadProgress",["Promise","DOM","Event","MAjaxify","MAjaxifyFormTypes","MLinkHack","MModalDialog","MProgressBar.react","React","ReactDOM","Stratcom","$","cx","fbt","promiseDone","qex","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){"use strict";__p&&__p();var x=5,y=8,z=500,A=.7,B=500,C=1e4,D=250,E=90;function F(a){this.$2=a,this.$3=h.find(this.$2,"div","inprogress"),this.$6=h.find(this.$2,"div","error"),this.$1=r("viewport"),this.$8=!1,this.$10=v._("684052"),this.$11=v._("691282"),this.$4=h.find(this.$3,"div","spinner-container"),this.$5=h.find(this.$3,"div","progress-bar-container"),this.$11&&this.$16(),this.$17(),this.$18(),this.$19(this.$6)}F.prototype.$16=function(){this.$13=p.render(o.createElement(n,{initialValue:0,className:"_6zj1"}),this.$5),this.$12=q.listen("MMultiPhotoUploader:upload:progress",null,function(event){var a=event.getData();this.$14=a.totalSize;this.$15=a.totalLoaded;this.$8&&this.$13&&(this.$14===this.$15?this.$13.animate(E,C):this.$13.animate(this.$20(),B))}.bind(this))};F.prototype.$21=function(a){h.show(a),w(function(){this.$2.style.transform="translateY(0%)"}.bind(this),0)};F.prototype.$22=function(a){return new g(function(b,c){this.$2.style.transform="translateY(100%)",w(function(){h.hide(a),b()},z)}.bind(this))};F.prototype.$23=function(a,b){w(function(){u(this.$22(a))}.bind(this),1e3*b)};F.prototype.$24=function(a,b){w(function(){u(this.$22(a),function(){h.remove(a)})}.bind(this),1e3*b)};F.prototype.$17=function(){window.addEventListener("beforeunload",function(a){if(!this.$8)return undefined;var b=t._("Ainda estamos carregando a sua publica\u00e7\u00e3o. Se voc\u00ea sair agora, ela n\u00e3o ser\u00e1 publicada.");a.returnValue=b;return b}.bind(this))};F.prototype.$18=function(){window.bgUploadInlineComposerCallback=function(){return this.blockNavigateToComposer()}.bind(this)};F.prototype.$19=function(a){var b=h.scry(a,"a");b.map(function(b){return i.listen(b,"click",function(){this.$22(a)}.bind(this))}.bind(this))};F.prototype.$25=function(a,b){__p&&__p();b.kill();var c=a.link;b=[];c.setAttribute("disabled","disabled");b.push({response:function(){F.openModalDialogWithPermalink(c,a.snowflakePermalink),this.$22(this.$7)}.bind(this),error:function(){var a=this.$22(this.$7);a=a.then(function(){return this.showErrorMsg()}.bind(this));u(a)}.bind(this)});j.form(null,a.form,null,k.NO_CACHE,null,!1,b)};F.prototype.$20=function(){var a=this.$15&&this.$14?this.$15/this.$14*100*A:0;return a};F.prototype.$26=function(){this.$13&&this.$13.animate(100,D);return new g(function(a,b){w(function(){a()},D)})};F.prototype.$27=function(){this.$8=!1,this.$15=null,this.$14=null};F.prototype.showErrorMsg=function(){this.$27();var a=this.$22(this.$3);a=a.then(function(){return this.$21(this.$6)}.bind(this));this.$23(this.$6,y);u(a)};F.prototype.setCompleteMsg=function(a,b){h.appendContent(this.$2,a),this.$19(a),this.$7=a,this.$9=b};F.prototype.setBackgroundUploadRunning=function(a,b){__p&&__p();if(!a&&!this.$8)return;if(a){this.$8=!0;this.$13&&b?(this.$13.setValue(this.$20()),h.hide(this.$4),h.show(this.$5),this.$14&&this.$15&&this.$14===this.$15&&(this.$13&&this.$13.animate(E,C))):(h.hide(this.$5),h.show(this.$4));this.$21(this.$3);return}this.$27();a=this.$13?this.$26().then(this.$22.bind(this,this.$3)):this.$22(this.$3);a=a.then(function(){return this.$21(this.$7)}.bind(this));this.$24(this.$7,this.$9||x);u(a)};F.prototype.blockNavigateToComposer=function(){if(this.$8){alert(t._("Voc\u00ea pode publicar novamente assim que sua \u00faltima publica\u00e7\u00e3o for publicada."));return!0}return!1};F.prototype.isRunning=function(){return this.$8};F.prototype.isWaitingForTagSuggestions=function(){return this.$10};F.prototype.setupTagFriendsButton=function(a){h.listen(a.link,"click",null,this.$25.bind(this,a))};F.openModalDialogWithPermalink=function(a,b){l.remove(a),m.openWithPermalinkURI(a.href,b)};var G=null;e.exports={init:function(){if(!G){var a=h.scry(r("static_templates"),"div","bg-upload-progress-root")[0];if(!a)return null;G=new F(a)}return G},getInstance:function(){return G},isRunning:function(){return!!(G&&G.isRunning())},setUploadFinished:function(a){if(!G)return;G.setCompleteMsg(a.completeMsg,a.msgDismissSeconds);G.setBackgroundUploadRunning(!1)},setUploadError:function(){if(!G)return;G.showErrorMsg()},setupTagFriendsButton:function(a){if(!G)return;G.setupTagFriendsButton(a)},isWaitingForTagSuggestions:function(){return!!(G&&G.isWaitingForTagSuggestions())}}}),null);
__d("UrlMap",["UrlMapConfig","invariant"],(function(a,b,c,d,e,f,g,h){a={resolve:function(a){var b="https";if(a in g)return b+"://"+g[a];a in g||h(0,2511,a);return""}};e.exports=a}),null);
__d("CommentPrivacyValue",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DEFAULT_PRIVACY:0,OWNER_OR_COMMENTER:1,FRIENDS_ONLY:2,FRIENDS_AND_POST_OWNER:3,SIDE_CONVERSATION:4,SIDE_CONVERSATION_AND_POST_OWNER:5,GRAPHQL_MULTIPLE_VALUE_HACK_DO_NOT_USE:-1})}),null);
__d("GridItem.react",["React","cx","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";function a(a){var b=a.alignv,c=a.alignh,d=a.className;a=babelHelpers.objectWithoutProperties(a,["alignv","alignh","className"]);return g.createElement("td",babelHelpers["extends"]({},a,{className:i(d,"_51m-"+(b==="top"?" vTop":"")+(b==="middle"?" vMid":"")+(b==="bottom"?" vBot":"")+(c==="left"?" hLeft":"")+(c==="center"?" hCent":"")+(c==="right"?" hRght":""))}))}e.exports=a}),null);
__d("Grid.react",["GridItem.react","React","cx","joinClasses"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k;k=babelHelpers.inherits(l,h.Component);k&&k.prototype;l.prototype.render=function(){__p&&__p();var a=this.props,b=a.alignh,c=a.alignv,d=a.children,e=a.cols,f=a.fixed,i=a.spacing,k=h.Children.count(d),m=[],n=[],o=0;h.Children.forEach(d,function(a,d){__p&&__p();if(a===null||a===undefined)return;var p=a.type===l.GridItem;o+=p?Math.max(a.props.colSpan||0,1):1;var q=o===e?"_51mw":"";p=p?h.cloneElement(a,{key:a.key||d,alignh:a.props.alignh||b,alignv:a.props.alignv||c,className:j(a.props.className,i,q)}):h.createElement(g,{alignh:b,alignv:c,className:j(i,q),key:a.key||d},a);n.push(p);if(o%e===0||d+1===k){if(f===!0&&o<e){for(var q=o;q<e;q++)n.push(h.createElement(g,{key:d+q}));o=e}m.push(h.createElement("tr",{className:"_51mx",key:d},n));n=[];o=0}});return h.createElement("table",babelHelpers["extends"]({},this.props,{className:j(this.props.className,"uiGrid _51mz"+(f===!0?" _5f0n":"")),cellSpacing:"0",cellPadding:"0"}),h.createElement("tbody",null,m))};function l(){k.apply(this,arguments)}l.GridItem=g;e.exports=l}),null);
__d("MStickersWebDriverIDs",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({STICKER_BUTTON:"MStickersWebDriverIDsStickerButton",STICKER_SELECTOR_CONTENT:"MStickersWebDriverIDsStickerSelectorContent",STICKER_NONSEARCH_PACK_BUTTON:"MStickersWebDriverIDsStickerNonsearchPackButton",STICKER_PACK_ITEM:"MStickersWebDriverIDsStickerPackItem"})}),null);
__d("StickerInterfaces",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({MESSAGES:"messages",NEO:"neo",COMMENTS:"comments",STICKERED:"stickered",COMPOSER:"composer",POSTS:"posts",FRAMES:"frames",SMS:"sms",MONTAGE:"montage"})}),null);
__d("XStickerPackImagesController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stickers/{pack_id}/images/",{pack_id:{type:"Int",required:!0},sticker_size:{type:"Int",defaultValue:50}})}),null);
__d("XStickerQueryImagesController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stickers/query/images/",{query:{type:"String",required:!0},sticker_interface:{type:"String"}})}),null);
__d("MStickerPack.react",["Grid.react","MRequest","MStickersInitialData","MStickersWebDriverIDs","MURI","React","Image.react","ReactComponentWithPureRenderMixin","ShimButton.react","StickerInterfaces","XStickerPackImagesController","XStickerQueryImagesController","cx","ix","fbt","debounceCore"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";__p&&__p();var w=g.GridItem,x=i.MRU_STICKER_PACK,y=14,z={};a=l.createClass({displayName:"MStickerPack",mixins:[n],getInitialState:function(){return{input:"",loading:!1,searching:!1,stickers:[]}},getDefaultProps:function(){return{isComments:!1}},UNSAFE_componentWillMount:function(){this._debouncedGetStickersForQuery=v(this.getStickersForQuery,500),this.getStickers(this.props.pack.id)},UNSAFE_componentWillReceiveProps:function(a){this.getStickers(a.pack.id)},componentWillUnmount:function(){this._debouncedGetStickersForQuery.reset()},updateRecentlyUsed:function(a){var b=z[x]||[];for(var c=0;c<b.length;++c)if(b[c].id===a.id){b.splice(c,1);break}b.unshift(a);z[x]||(z[x]=b,i.packs.unshift(i.mru))},getStickers:function(a){__p&&__p();if(!a||a==i.SEARCH_PACK)return;if(a in z){this.setState({input:"",loading:!1,stickers:z[a],searching:!1});return}var b=q.getURIBuilder().setInt("pack_id",a).getURI();b=new h(new k(b));b.listen("done",function(b){z[a]=b.payload,this.isMounted()&&this.setState({input:"",loading:!1,stickers:b.payload,searching:!1})}.bind(this));this.setState({loading:!0});b.send()},getStickersForQuery:function(a,b){__p&&__p();if(a.length===0){this.setState({loading:!1,searching:!1});return}if(a!=this.state.input&&!b)return;b=r.getURIBuilder().setString("query",a).setString("sticker_interface",this.props.isComments?p.COMMENTS:p.MESSAGES).getURI();b=new h(new k(b));b.listen("done",function(b){b=b.payload||[];this.isMounted()&&a==this.state.input&&this.setState({loading:!1,stickers:b,searching:!0})}.bind(this));this.setState({loading:!0});b.send()},selectSticker:function(a){this.updateRecentlyUsed(a),this.props.onSelect&&this.props.onSelect(a.id)},renderSticker:function(a,b){__p&&__p();var c=null;if(this.props.isComments&&!a.isCommentsCapable){if(this.props.pack.id==i.MRU_STICKER_PACK)return}else if(!this.props.isComments&&!a.isMessengerCapable){if(this.props.pack.id==i.MRU_STICKER_PACK)return}else c=this.selectSticker.bind(this,a);var d=null;this.props.isFlyout&&(d="composer-submit");return l.createElement("button",{className:"_5asg","data-testid":j.STICKER_PACK_ITEM,"data-sigil":d,key:"sticker-"+b,onClick:c,role:"button"},l.createElement(m,{src:a.uri,alt:u._("Figurinha {sticker name} de {pack name}",[u._param("pack name",a.packName),u._param("sticker name",a.accessibilityLabel)])}))},_getRenderedFakeStickers:function(){return Array.from(new Array(y),function(a,b){return l.createElement("div",{key:"fake-"+b,className:"_u2_"})})},_getRenderedStickerGridItems:function(){return this.state.stickers.map(this.renderSticker).concat(this._getRenderedFakeStickers())},render:function(){if(this.props.pack.id==i.SEARCH_PACK)return l.createElement("div",{className:"_5ash"},l.createElement("div",{className:"_5ef_"},this._renderSearch(),this._renderTags(),this._renderStickerSearchResults()),this._renderLoading());return this.state.loading?l.createElement("div",{className:"_5ash"},this._renderLoading()):l.createElement("div",{className:"_5ash"+(this.props.isComments&&!this.props.pack.isCommentsCapable?" _5jkg":""),onScroll:this.props.onScroll},l.createElement("div",{className:"_5ef_",onScroll:this._onScroll},this._getRenderedStickerGridItems()),this.renderMask())},_renderLoading:function(){return!this.state.loading?null:l.createElement("span",{className:"_5asi"},u._("Carregando..."))},_renderStickerSearchResults:function(){if(!this.state.searching||this.state.loading)return null;return this.state.stickers.length===0?l.createElement("div",{className:"_4op9"},l.createElement(m,{src:t("87146")}),l.createElement("p",null,u._("Nenhuma figurinha para mostrar"))):l.createElement("div",{className:"_5ash"+(this.props.isComments&&!this.props.pack.isCommentsCapable?" _5jkg":""),onScroll:this.props.onScroll},l.createElement("div",{className:"_5ef_"},this._getRenderedStickerGridItems()),this.renderMask())},renderMask:function(){return!(this.props.isComments&&!this.props.pack.isCommentsCapable)?null:l.createElement("div",{className:"_5jkh"},l.createElement("div",{className:"_5jki"},u._("Este pacote est\u00e1 dispon\u00edvel apenas em mensagens")))},_renderSearch:function(){return l.createElement("div",{className:"_2j-l"},l.createElement("span",{className:"_2j-m"}),this._renderCloseButton(),l.createElement("div",{className:"_4opa"},l.createElement("input",{className:"_2j-n",onChange:this._inputChanged,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,ref:"stickerQuery",value:this.state.input,placeholder:u._("Pesquisar figurinhas"),type:"text"})))},_renderCloseButton:function(){if(this.state.input.length>0)return l.createElement(o,{className:"_4opb",inline:!0,onClick:this._clearInput})},_renderTags:function(){if(this.state.searching||this.state.loading)return null;var a=i.tags.filter(function(a){return a.sourceURI!==null}).sort(function(a,b){return a.order-b.order}).map(function(a,b){return l.createElement(w,{className:"_2j-o",key:b},l.createElement("div",{className:"_2j-p"},l.createElement(o,{className:"_2j-q",onClick:this._selectTag.bind(this,a),style:{background:"#"+a.color_code}},l.createElement(m,{src:a.sourceURI}),l.createElement("span",null,a.name))))}.bind(this));return l.createElement(g,{className:"_2j-r",cols:2,fixed:!0,ref:"grid"},a)},_inputChanged:function(event){this.setState({input:event.target.value}),this._debouncedGetStickersForQuery(event.target.value,!1)},_clearInput:function(){this.setState({input:"",loading:!1,searching:!1})},_selectTag:function(a){this.setState({input:a.name}),this.getStickersForQuery(a.name,!0)}});e.exports=a}),null);
__d("MStickerPackButton.react",["Image.react","MStickersInitialData","MStickersWebDriverIDs","React","ShimButton.react","cx"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m;b=babelHelpers.inherits(a,j.PureComponent);m=b&&b.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=m.constructor).call.apply(a,[this].concat(d)),this.onClick=function(){this.props.onclick&&this.props.onclick(this.props.pack)}.bind(this),b}a.prototype.render=function(){"use strict";var a="_5arz _5cni"+(this.props.selected?" _5ar-":"")+(this.props.disabled?" _4f39":""),b=this.props.pack,c;b.id==h.MRU_STICKER_PACK?c=j.createElement("span",{className:"_3rsg"}):b.id==h.SEARCH_PACK?c=j.createElement("span",{className:"_cmr"}):c=j.createElement(g,{src:b.icon,alt:b.name});b=b.id==h.SEARCH_PACK?null:i.STICKER_NONSEARCH_PACK_BUTTON;return j.createElement(k,{className:a,"data-testid":b,form:"link",onClick:this.onClick,rel:"ignore"},j.createElement("div",{className:"_3pcz"},c))};e.exports=a}),null);
__d("XStickerStorePermalinkController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stickers/",{tab:{type:"String"},redirect_uri:{type:"String"},is_comments:{type:"Bool",defaultValue:!1}})}),null);
__d("MStickerSelector.react",["BanzaiLogger","DOM","MPageController","MParent","MStickerPack.react","MStickerPackButton.react","MStickersInitialData","MStickersWebDriverIDs","MViewport","React","ReactDOM","Stratcom","SubscriptionsHandler","UserAgent","XStickerStorePermalinkController","cx","fbt","getActiveElement"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){__p&&__p();var y;b=p.PropTypes;var z="feed-ufi-comments",A="scroll-area";c=48;var B=5*c;d=babelHelpers.inherits(a,p.Component);y=d&&d.prototype;function a(a){"use strict";__p&&__p();y.constructor.call(this,a);this.$1=null;this.onPackSelect=function(a){g.log("MTouchStickersLoggerConfig",{event:"select_pack",packid:a.id}),this.setState({selectedPack:a})}.bind(this);this.onPackScroll=function(){this.state.selectedPack&&this.state.selectedPack.id!=this.$2&&(this.$2=this.state.selectedPack.id,g.log("MTouchStickersLoggerConfig",{event:"scroll_pack",packid:this.state.selectedPack.id}))}.bind(this);this.onInputFocus=function(){this.setState({inputFocused:!0})}.bind(this);this.onInputBlur=function(){this.setState({inputFocused:!1})}.bind(this);this.scrollPrev=function(){if(!this.state.prevDisabled){var a=Math.max(this.state.scrollLeft-B,0);this.setState({scrollLeft:a,prevDisabled:a===0,nextDisabled:!1})}}.bind(this);this.scrollNext=function(){if(!this.state.nextDisabled){var a=q.findDOMNode(this.refs.selectorRow);a=a.scrollWidth-a.parentNode.clientWidth;a=Math.min(this.state.scrollLeft+B,a);this.setState({scrollLeft:a,prevDisabled:!1,nextDisabled:this.$3(a)})}}.bind(this);this.$3=function(a){var b=q.findDOMNode(this.refs.selectorRow);b=b.scrollWidth-b.parentNode.clientWidth;return a>=b}.bind(this);this.renderPack=function(a,b){return p.createElement(l,{disabled:this.props.isComments&&!a.isCommentsCapable||!this.props.isComments&&!a.isMessengerCapable,key:"pack-"+b,onclick:this.onPackSelect,pack:a,selected:a.id==this.state.selectedPack.id})}.bind(this);this.renderIndicator=function(){return!m.storeIndicator?null:p.createElement("div",{className:"_5e-s"})};this.$5=function(){return p.createElement("a",{"aria-label":w._("Pacotes de figurinhas anteriores"),className:"_5cni _5abu",disabled:this.state.prevDisabled,href:"#",onClick:this.scrollPrev,ref:"prevButton",rel:"ignore",role:"button"},p.createElement("span",{className:"_5abw"}))}.bind(this);this.$6=function(){return p.createElement("a",{"aria-label":w._("Pr\u00f3ximo pacote de figurinhas"),className:"_5cni _5abx",disabled:this.state.nextDisabled,href:"#",onClick:this.scrollNext,ref:"nextButton",rel:"ignore",role:"button"},p.createElement("span",{className:"_5aby"}))}.bind(this);this.$7=function(){this.setState({nextDisabled:this.$3(this.state.scrollLeft)})}.bind(this);this.$4=function(event){var a=x();a&&a.blur()};this.$8=function(){__p&&__p();if(this.$1)return;var a=q.findDOMNode(this.refs.root);if(!a)return;if(j.bySigil(a,A)){var b=new s();b.addSubscriptions(h.listen(a,"touchmove",null,function(event){event.stop()}),r.listen("m:page:unload",null,function(){this.$9()}.bind(this)));j.bySigil(a,z)&&b.addSubscriptions(r.listen("m:feed-ufi-flyout:reset",null,function(){this.$9()}.bind(this)));this.$1=b}}.bind(this);this.$9=function(){this.$1&&this.$1.release(),this.$1=null}.bind(this);var b=null;if(m.packs&&m.packs.length)for(var c=0;c<m.packs.length;c++)if(!a.isComments&&m.packs[c].isMessengerCapable||a.isComments&&m.packs[c].isCommentsCapable){b=m.packs[c];break}this.state={selectedPack:b,prevDisabled:!0,nextDisabled:!1,scrollLeft:0}}a.prototype.render=function(){"use strict";__p&&__p();if(!this.props.isOpen)return null;var a=m.packs.length===0?p.createElement("div",{className:"_5ar_"},w._("Nenhuma figurinha dispon\u00edvel")):p.createElement(k,{pack:this.state.selectedPack,onSelect:this.props.callback,onScroll:this.onPackScroll,onInputFocus:this.onInputFocus,onInputBlur:this.onInputBlur,isComments:this.props.isComments,isFlyout:this.props.isFlyout}),b=m.packs,c=[];for(var d=0;d<b.length;d++)b[d]&&(this.props.isComments&&b[d].isCommentsCapable?c.push(b[d]):b[d].isMessengerCapable&&c.push(b[d]));b=c;b=b.map(this.renderPack,this);d=u.getURIBuilder().setString("redirect_uri",i.getRenderedPath()).setBool("is_comments",this.props.isComments).getURI();c=null;this.props.showStore&&(c=p.createElement("a",{className:"_5cni _5b3_",href:d.toString()},p.createElement("span",{className:"_5b40"}),this.renderIndicator()));d=t.isPlatform("Android <2.4");return p.createElement("div",{className:this.props.className,"data-testid":n.STICKER_SELECTOR_CONTENT,ref:"root"},p.createElement("div",{className:"_5as0"+(d?" _2-n8":""),ref:"selector"},p.createElement("div",{className:"_5as1",onScroll:this.state.inputFocused?this.$4:null},a),p.createElement("div",{className:"_5as2",ref:"selectorRow",style:{marginLeft:-this.state.scrollLeft}},p.createElement("div",{className:"_5as5"},b)),this.$5(),this.$6(),c))};a.prototype.componentDidMount=function(){"use strict";this.props.isOpen&&(this.$8(),this.$7())};a.prototype.componentWillUnmount=function(){"use strict";this.$9()};a.prototype.componentDidUpdate=function(a,b){"use strict";__p&&__p();if(this.props.isOpen){a.isOpen||this.$8();if(this.state.selectedPack!=b.selectedPack||this.props.isOpen!=a.isOpen){b=q.findDOMNode(this.refs.selector);j.bySigil(b,z)?r.invoke("MStickerSelector:show-sticker-selector",null,{selectorNode:b}):o.scrollToNodeIfNecessary(q.findDOMNode(this.refs.selector))}this.props.isOpen!=a.isOpen&&(this.$7(),g.log("MTouchStickersLoggerConfig",{event:"open_tray"}))}else a.isOpen&&this.$9()};a.propTypes={callback:b.func.isRequired,isComments:b.bool.isRequired,isOpen:b.bool,onClose:b.func,showStore:b.bool.isRequired,isFlyout:b.bool};a.defaultProps={isComments:!0,showStore:!0};e.exports=a}),null);
__d("MStickerSelectorButton.react",["Image.react","React","asset","cx","fbt","ix"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m;b=h.PropTypes;c=babelHelpers.inherits(a,h.Component);m=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=m.constructor).call.apply(a,[this].concat(d)),this.state={isSelected:this.props.isSelected},this.onClick=function(event){this.setState({isSelected:!this.state.isSelected}),this.props.onClick&&this.props.onClick(event)}.bind(this),b}a.prototype.UNSAFE_componentWillUpdate=function(a,b){"use strict";a!==this.props&&this.setState({isSelected:a.isSelected}),this.props.onToggle&&b!==this.state&&this.props.onToggle(b.isSelected)};a.prototype.render=function(){"use strict";var a;!this.state.isSelected?a=l("90727"):a=l("90728");return h.createElement("button",{"aria-label":k._("Adicionar figurinha"),type:"button",className:"_5ecn _1n29 _2fv6","data-sigil":"touchable",onClick:this.onClick},h.createElement(g,{src:a,className:"_2fv7"}),h.createElement(g,{src:this.state.isSelected?l("432358"):l("432368"),className:"_2fv8"}))};a.propTypes={onToggle:b.func,isSelected:b.bool};a.defaultProps={isSelected:!1};e.exports=a}),null);
__d("MStickerMount",["BanzaiLogger","ClientIDs","CommentPrivacyValue","DOM","MAjaxify","MCommentStatusLogger","MRequest","MStickerSelector.react","MStickerSelectorButton.react","ReactComponentRenderer","Run","Stratcom","SubscriptionsHandler","requireWeak","$"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){"use strict";__p&&__p();var v={logPost:function(a,b){return undefined}};t("MPrivateCommentsLogger",function(a){v=a});var w="m-textarea-input",x=function(a,b,c,d){__p&&__p();var e=new m(a.action);e.setMethod("POST");e.addData({client_id:h.getNewClientID(),sticker_id:b});var f=j.convertFormToDictionary(a);f.privacy_value&&e.addData({privacy_value:f.privacy_value});v.logPost(parseInt(f.privacy_value,10)===i.OWNER_OR_COMMENTER,a.id);if(c){f=l.newInteractionKey();l.logInitAndSubmitSticker(f,b);e.addData({logging_interaction_key:f});z(f)}k.ajaxify(null,a,e,"async_composer");r.invoke("m:ufi:sticker-comment",null,{textInput:d})},y=function(a,b,c,d,e,f,g){__p&&__p();g===void 0&&(g=!1);var h,i=new p(n,b);i.setProps({callback:d,isComments:e,onClose:function(){i&&i.setProps({isOpen:!1}),h&&h.setProps({isSelected:!1})},showStore:f,isFlyout:g});h=new p(o,a);h.setProps({onToggle:function(a){i.setProps({isOpen:a})}});var k=new s();k.addSubscriptions(j.listen(c,"focus",null,function(){h.setProps({isSelected:!1})}),r.listen("m:ufi:sticker-comment",null,function(){h.setProps({isSelected:!1})}));q.onLeave(function(){k.release(),h.unmount(),i.unmount()})};function z(a){__p&&__p();var b=new s();b.addSubscriptions(r.listen("m:ufi:live-comments:render",null,function(event){var c=event.getData()||{};c=c.logKeys;c&&c.forEach(function(c){c===a&&(l.logRender(a),b.release())})}),r.listen("m:ufi:iui:comment-added",null,function(event){var c=event.getData().loggingInteractionKey;c===a&&(l.logRender(a),b.release())}),r.listen("m:page:unload",null,function(){b.release()}));return b}a={initMessages:function(a,b,c,d){var e=u(c);c=function(a){var b=e.form,c=j.convertFormToDictionary(b);c.sticker_id=a;d.sendRequest(b.action,c)};y(a,b,e,c,!1,!0)},initCommentsFlyout:function(a,b,c,d,e){e===void 0&&(e=!1);var f=null;d&&(r.hasSigil(d,w)?f=d:f=j.scry(d,"*",w)[0]);f||(f=u(c));var h=f.form;b.onclick=function(){x(h,a,e,f),g.log("NullStateCommentsLoggerConfig",{event:"sticker_selection",sticker_id:a.toString()})}},initComments:function(a,b,c,d,e,f){e===void 0&&(e=!1);f===void 0&&(f=!1);var g=null;d&&(r.hasSigil(d,w)?g=d:g=j.scry(d,"*",w)[0]);g||(g=u(c));var h=g.form;d=function(a){x(h,a,e,g)};y(a,b,g,d,!0,!0,f)},initNewMessage:function(a,b,c,d){var e=function(a){d.sendSticker(a)};y(a,b,c,e,!1,!1)}};e.exports=a}),null);
__d("MMultiPhotoUploaderAttachmentType",[],(function(a,b,c,d,e,f){a={VIDEO:"video",PHOTO:"photo",AUDIO:"audio"};e.exports=a}),null);
__d("MMultiPhotoUploaderAttachment.react",["ix","Image.react","MLoadingIndicator.react","MMultiPhotoUploaderAttachmentState","MMultiPhotoUploaderAttachmentType","MProgressBar.react","React","ShimButton.react","asset","cx","fbt","joinClasses"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){__p&&__p();var s,t=2,u=.7,v=500,w=1e4,x=250;b=babelHelpers.inherits(a,m.Component);s=b&&b.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=s.constructor).call.apply(a,[this].concat(d)),this.$1=!1,this.$2=0,this.state={previewLoaded:!1},this.getError=function(){return this.props.state!==j.ERROR?null:m.createElement("div",{className:"_5r-4"})}.bind(this),this.getAbortButton=function(){var a=this.props.shouldShowWhiteDesign?"_3lx9":"_5r-6",b=this.props.shouldShowWhiteDesign?"_3lxa":"_5r-5";return m.createElement(n,{"aria-label":q._("Remover foto"),className:b,"data-sigil":"touchable",onClick:this.props.onRemoveClick},m.createElement("div",{className:a}))}.bind(this),this.getTagCountIndicator=function(){if(this.props.state!==j.UPLOADED&&this.props.state!==j.POLLING_TAG_SUGGESTIONS)return null;if(!this.state.previewLoaded)return null;var a=this.props.tagCount;if(!a)return null;a="_5pt"+(a===1?" _5pu":"")+(a===2?" _5pv":"")+(a>2?" _5pw":"");return m.createElement("div",{className:a})}.bind(this),b}a.prototype.componentDidMount=function(){"use strict";this.$1=!0,(this.props.state===j.UPLOADED||this.props.state===j.POLLING_TAG_SUGGESTIONS)&&!this.state.previewLoaded&&this.loadPreview()};a.prototype.componentDidUpdate=function(a,b){"use strict";if(this.refs.progressBar&&(this.props.state===j.SENDING&&this.props.loaded&&this.props.totalSize))if(this.props.loaded===this.props.totalSize)this.refs.progressBar.animate(100,w);else{var c=100*u*this.props.loaded/this.props.totalSize;this.refs.progressBar.animate(c,v)}a.state===j.SENDING&&this.props.state!==j.SENDING&&this.props.state!==j.ERROR&&this.loadPreview();!b.previewLoaded&&this.state.previewLoaded&&this.props.onPreviewLoaded&&this.props.onPreviewLoaded()};a.prototype.componentWillUnmount=function(){"use strict";this.$1=!1};a.prototype.getLoadingIndicator=function(){"use strict";if(this.props.hideUploadProgress)return null;return this.props.loaded>0&&!this.state.previewLoaded?this.getProgressBar():this.getSpinner()};a.prototype.getProgressBar=function(){"use strict";if(this.props.state===j.ERROR)return null;return this.state.previewLoaded?null:m.createElement("div",{className:"_r6h"},m.createElement(l,{initialValue:0,ref:"progressBar"}))};a.prototype.getSpinner=function(){"use strict";return this.props.state!==j.SENDING&&this.props.state!==j.POLLING_TAG_SUGGESTIONS?null:m.createElement("div",{className:"_451h"+(this.props.state===j.POLLING_TAG_SUGGESTIONS?" _2d1s":"")},m.createElement(i,{className:"_5r-2"}))};a.prototype.loadPreview=function(){"use strict";__p&&__p();if(this.props.type===k.VIDEO){this.setState({previewLoaded:!0});return}var a=++this.$2;this.refs.progressBar&&this.refs.progressBar.animate(100,w);var b=new Image();b.onload=function(){if(!this.$1||a!==this.$2)return;this.refs.progressBar?(this.refs.progressBar.animate(100,x),setTimeout(function(){if(!this.$1||a!==this.$2)return;this.setState({previewLoaded:!0})}.bind(this),x)):this.setState({previewLoaded:!0})}.bind(this);b.src=this.props.imageURI;(b.complete||b.width+b.height>0)&&(b.onload=null,this.setState({previewLoaded:!0}))};a.prototype.getPreviewWithLocalFile=function(a){"use strict";var b=this.props.state===j.SENDING||!this.state.previewLoaded;return b||!this.props.imageURI?!this.props.fileImageURI?null:m.createElement(h,{className:"_5r-3"+(b&&!this.props.hideUploadProgress?" _451j":""),src:this.props.fileImageURI,height:a,width:a}):m.createElement(h,{className:"_5r-3",src:this.props.imageURI,height:a,width:a})};a.prototype.getPreview=function(a,b){"use strict";if(this.props.useLocalFilePreview)return this.getPreviewWithLocalFile(b);if(this.props.state!==j.UPLOADED&&this.props.state!==j.POLLING_TAG_SUGGESTIONS)return null;return!this.state.previewLoaded?null:m.createElement(h,{className:"_5r-3",src:this.props.imageURI,width:a,height:b})};a.prototype.getPhotoBorder=function(){"use strict";var a=null;this.props.shouldShowWhiteDesign&&(a=m.createElement("div",{className:"_23rn"}));return a};a.prototype.getSphericalPhotoIcon=function(){"use strict";return!this.props.isSpherical?null:m.createElement("div",{className:"_42p8"+(!this.state.previewLoaded||this.props.state!==j.UPLOADED&&this.props.state!==j.POLLING_TAG_SUGGESTIONS?" _42p9":"")})};a.prototype.getVideoBadge=function(){"use strict";return this.props.type!==k.VIDEO?null:m.createElement("div",{className:"_451k"},m.createElement(h,{className:"_451l",src:g("484861")}))};a.prototype.render=function(){"use strict";__p&&__p();var a;this.props.shouldShowWhiteDesign?a="_s50":this.props.shouldShowLargeThumbnails?a="_3vnj":a="_51s2";var b=this.props.previewSize-t,c=b;(this.props.state===j.UPLOADED||this.props.state===j.POLLING_TAG_SUGGESTIONS)&&this.state.previewLoaded&&this.props.shouldShowLargeThumbnails&&this.props.thumbnail_width&&this.props.thumbnail_height&&(c=Math.floor(this.props.thumbnail_width*b/this.props.thumbnail_height));var d=this.props.useLocalFilePreview?{}:{width:c};return m.createElement("div",{className:r(this.props.className,a),style:d},m.createElement("div",{onClick:function(){if(this.props.type===k.VIDEO)return;this.props.onThumbnailClicked()}.bind(this),"data-sigil":"touchable",role:"presentation"},this.getPreview(c,b),this.getLoadingIndicator(),this.getError(),this.getTagCountIndicator(),this.getPhotoBorder(),this.getSphericalPhotoIcon(),this.getVideoBadge()),this.getAbortButton())};e.exports=a}),null);
__d("MMultiPhotoUploaderHiddenInputs.react",["React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;b=g.PropTypes;h=babelHelpers.inherits(a,g.Component);h&&h.prototype;a.prototype.render=function(){"use strict";var a=null;this.props.waterfallSource&&(a=g.createElement("input",{name:"waterfall_source",type:"hidden",value:this.props.waterfallSource}));return g.createElement("div",null,a,this.props.photo_fbids.map(function(a){return g.createElement("input",{key:a,type:"hidden",name:"photo_ids["+a+"]",value:a})}),this.props.video_fbids.map(function(a){return g.createElement("input",{key:a,type:"hidden",name:"video_ids["+a+"]",value:a})}))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={photo_fbids:b.array.isRequired,video_fbids:b.array.isRequired,waterfallSource:b.string};e.exports=a}),null);
__d("MMultiPhotoUploaderPlusAttachment.react",["MXUILayout.react","MXUILayoutFillColumn.react","React","ShimButton.react","cx","fbt"],(function(a,b,c,d,e,f,g,h,i,j,k,l){__p&&__p();var m;m=babelHelpers.inherits(a,i.Component);m&&m.prototype;a.prototype.getAttachmentChildContainer=function(){"use strict";if(!this.props.shouldShowWhiteDesign)return null;var a=this.props.shouldShowAddPhotoLabel?i.createElement("div",{className:"_vbw"},l._("Foto")):null,b=this.props.shouldShowAddVideoLabel?i.createElement("div",{className:"_vbw"},l._("V\u00eddeos")):null;return i.createElement(g,null,i.createElement(h,{alignself:"center",className:"_2-24"},i.createElement("div",{className:"_vbx"},i.createElement("div",{className:"_vby"}),a,b)))};a.prototype.getAttachmentClass=function(){"use strict";var a,b=this.props.largeThumbnails;this.props.shouldShowWhiteDesign?a="_vbz":a=(b?"_3vnj":"")+(b?"":" _51s2")+(b?" _14y0":"")+(b?"":" _5e0r");return a};a.prototype.render=function(){"use strict";var a=this.getAttachmentClass(),b=this.getAttachmentChildContainer();return i.createElement(j,{"aria-label":l._("Adicionar foto"),className:a,"data-sigil":"touchable",onClick:this.props.onClick},b)};function a(){"use strict";m.apply(this,arguments)}e.exports=a}),null);
__d("MPhotoUploadDisable",["DOM","Stratcom","fbt"],(function(a,b,c,d,e,f,g,h,i){a={IOS_8_PHOTO_UPLOAD_DISABLE_MESSAGE:i._("O carregamento de fotos n\u00e3o est\u00e1 dispon\u00edvel para o Safari no iOS 8.0 e 8.0.1. A Apple corrigiu isso na vers\u00e3o mais recente do iOS. Atualize para o iOS 8.0.2 e tente novamente."),alertIOS8FileUploadDisabled:function(event){alert(this.IOS_8_PHOTO_UPLOAD_DISABLE_MESSAGE),event.kill()},disableIOS8FileUpload:function(a){this._listeners=[g.listen(a,"click",null,this.alertIOS8FileUploadDisabled.bind(this)),h.listen("m:page:unload",null,this._cleanup.bind(this))]},_cleanup:function(){this._listeners.forEach(function(a){a.remove()})}};e.exports=a}),null);
__d("MPhotoUploadFileInput",["DOM","MTouchClick"],(function(a,b,c,d,e,f,g,h){__p&&__p();function a(a){"use strict";this.$1=a}a.prototype.setChangeHandler=function(a){"use strict";this.$2&&this.$2.remove(),this.$3=a,this.$3!=null&&(this.$2=g.listen(this.$1,"change",null,this.$3))};a.prototype.setClickHandler=function(a){"use strict";this.$4&&this.$4.remove(),this.$5=a,this.$5!=null&&(this.$4=g.listen(this.$1,"click",null,this.$5))};a.prototype.destroy=function(){"use strict";this.setChangeHandler(null),this.setClickHandler(null)};a.prototype.getDOMElement=function(){"use strict";return this.$1};a.prototype.cloneDOMNode=function(){"use strict";var a=this.$1;this.$1=a.cloneNode(!0);this.$1.value="";g.replace(a,this.$1);this.$3&&this.setChangeHandler(this.$3);this.$5&&this.setClickHandler(this.$5);return a};a.prototype.click=function(a){"use strict";var event=a.nativeEvent,b=event.changedTouches;h.click(this.$1,{getRawEvent:function(){return event},getTouch:function(){return b&&b[0]||{}}})};e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/vYaRhD_0hEI/
 */
__d("MegaPixImage",[],(function(a,b,c,d,e,f){__p&&__p();function g(a){var b=a.naturalWidth,c=a.naturalHeight;if(b*c>1024*1024){c=document.createElement("canvas");c.width=c.height=1;c=c.getContext("2d");c.drawImage(a,-b+1,0);return c.getImageData(0,0,1,1).data[3]===0}else return!1}function h(a,b,c){__p&&__p();b=document.createElement("canvas");b.width=1;b.height=c;b=b.getContext("2d");b.drawImage(a,0,0);a=b.getImageData(0,0,1,c).data;b=0;var d=c,e=c;while(e>b){var f=a[(e-1)*4+3];f===0?d=e:b=e;e=d+b>>1}f=e/c;return f===0?1:f}function i(a,b,c){var d=document.createElement("canvas");j(a,d,b,c);return d.toDataURL("image/jpeg",b.quality||.8)}function j(a,b,c,d){__p&&__p();var e=a.naturalWidth,f=a.naturalHeight,i=c.width,j=c.height,l=b.getContext("2d");l.save();k(b,i,j,c.orientation);b=g(a);b&&(e/=2,f/=2);c=1024;b=document.createElement("canvas");b.width=b.height=c;var m=b.getContext("2d");d=d?h(a,e,f):1;i=Math.ceil(c*i/e);j=Math.ceil(c*j/f/d);d=0;var n=0;while(d<f){var o=0,p=0;while(o<e)m.clearRect(0,0,c,c),m.drawImage(a,-o,-d),l.drawImage(b,0,0,c,c,p,n,i,j),o+=c,p+=i;d+=c;n+=j}l.restore();b=m=null}function k(a,b,c,d){__p&&__p();switch(d){case 5:case 6:case 7:case 8:a.width=c;a.height=b;break;default:a.width=b,a.height=c}a=a.getContext("2d");switch(d){case 2:a.translate(b,0);a.scale(-1,1);break;case 3:a.translate(b,c);a.rotate(Math.PI);break;case 4:a.translate(0,c);a.scale(1,-1);break;case 5:a.rotate(.5*Math.PI);a.scale(1,-1);break;case 6:a.rotate(.5*Math.PI);a.translate(0,-c);break;case 7:a.rotate(.5*Math.PI);a.translate(b,-c);a.scale(-1,1);break;case 8:a.rotate(-.5*Math.PI);a.translate(-b,0);break;default:break}}var l=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;function a(a){__p&&__p();if(a instanceof Blob){var b=new Image();if(!l)throw Error("No createObjectURL function found to create blob url");b.src=l.createObjectURL(a);this.blob=a;a=b}if(!a.naturalWidth&&!a.naturalHeight){var c=this;a.onload=function(){var a=c.imageLoadListeners;if(a){c.imageLoadListeners=null;for(var b=0,d=a.length;b<d;b++)a[b]()}};this.imageLoadListeners=[]}this.srcImage=a}a.isSupported=!!l;a.prototype.render=function(a,b){__p&&__p();if(this.imageLoadListeners){var c=this;this.imageLoadListeners.push(function(){c.render(a,b)});return}b=b||{};var d=this.srcImage.naturalWidth,e=this.srcImage.naturalHeight,f=b.width,g=b.height,h=b.maxWidth,k=b.maxHeight,l=!this.blob||this.blob.type==="image/jpeg";f&&!g?g=e*f/d<<0:g&&!f?f=d*g/e<<0:(f=d,g=e);h&&f>h&&(f=h,g=e*f/d<<0);k&&g>k&&(g=k,f=d*g/e<<0);h={width:f,height:g};for(var m in b)h[m]=b[m];k=a.tagName.toLowerCase();k==="img"?a.src=i(this.srcImage,h,l):k==="canvas"&&j(this.srcImage,a,h,l);typeof this.onrender==="function"&&this.onrender(a)};e.exports=a}),null);
__d("PUWSteps",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CLIENT_FLOW_BEGIN:"client_flow_begin",CLIENT_SELECT_BEGIN:"client_select_begin",CLIENT_SELECT_SUCCESS:"client_select_success",CLIENT_SELECT_CANCEL:"client_select_cancel",CLIENT_SELECT_FAIL:"client_select_fail",CLIENT_FLOW_POST:"client_flow_post",CLIENT_TRANSFER_BATCH_BEGIN:"client_transfer_batch_begin",CLIENT_UPLOAD_BEGIN:"client_upload_begin",CLIENT_ATTACH_PHOTO:"client_attach_photo",CLIENT_PROCESS_BEGIN:"client_process_begin",CLIENT_PROCESS_SUCCESS:"client_process_success",CLIENT_PROCESS_CANCEL:"client_process_cancel",CLIENT_PROCESS_SKIP:"client_process_skip",CLIENT_PROCESS_FAIL:"client_process_fail",CLIENT_PROCESS_UNAVAILABLE:"client_process_unavailable",CLIENT_SPHERICAL_CHECK_SUCCESS:"client_spherical_check_success",CLIENT_SPHERICAL_CHECK_FAIL:"client_spherical_check_fail",CLIENT_TRANSFER_ENQUEUE:"client_transfer_enqueue",CLIENT_TRANSFER_BEGIN:"client_transfer_begin",CLIENT_TRANSFER_SUCCESS:"client_transfer_success",CLIENT_TRANSFER_CANCEL:"client_transfer_cancel",CLIENT_TRANSFER_FAIL:"client_transfer_fail",CLIENT_TRANSFER_MANUAL_RETRY:"client_transfer_manual_retry",CLIENT_UPLOAD_SUCCESS:"client_upload_success",CLIENT_UPLOAD_FAIL:"client_upload_fail",CLIENT_UPLOAD_CANCEL:"client_upload_cancel",CLIENT_UPLOAD_REMOVE:"client_upload_remove",CLIENT_FACEREC_BEGIN:"client_facerec_begin",CLIENT_FACEREC_SUCCESS:"client_facerec_success",CLIENT_FACEREC_FAIL:"client_facerec_fail",CLIENT_PHOTO_PREVIEW_OPEN:"client_photo_preview_open",CLIENT_PHOTO_PREVIEW_CLOSE:"client_photo_preview_close",CLIENT_TRANSFER_BATCH_SUCCESS:"client_transfer_batch_success",CLIENT_TRANSFER_BATCH_CANCEL:"client_transfer_batch_cancel",CLIENT_TRANSFER_BATCH_FAIL:"client_transfer_batch_fail",CLIENT_PUBLISH_ENQUEUE:"client_publish_enqueue",CLIENT_PUBLISH_BEGIN:"client_publish_begin",CLIENT_PUBLISH_SUCCESS:"client_publish_success",CLIENT_PUBLISH_FAIL:"client_publish_fail",CLIENT_ATTEMPT_FAIL:"client_attempt_fail",CLIENT_FLOW_SUCCESS:"client_flow_success",CLIENT_FLOW_FATAL:"client_flow_fatal",CLIENT_FLOW_GIVEUP:"client_flow_giveup",CLIENT_FLOW_CANCEL:"client_flow_cancel",CLIENT_FLOW_FAIL:"client_flow_fail",CLIENT_FLOW_INCOMPLETE:"client_flow_incomplete",CLIENT_ATTEMPT_INCOMPLETE:"client_attempt_incomplete",CLIENT_FLOW_RETRY:"client_flow_retry",CLIENT_ATTEMPT_RETRY:"client_attempt_retry",CLIENT_DIAGNOSTIC:"client_diagnostic",CLIENT_QUALITY_SWITCH:"client_quality_switch",CLIENT_CANCEL_SURVEY:"client_cancel_survey",CLIENT_PHOTO_EDIT_BEGIN:"client_photo_edit_begin",CLIENT_PHOTO_EDIT_SUCCESS:"client_photo_edit_success",SERVER_UPLOAD_BEGIN:"server_upload_begin",SERVER_UPLOAD_SUCCESS:"server_upload_success",SERVER_UPLOAD_FAIL:"server_upload_fail",SERVER_PUBLISH_BEGIN:"server_publish_begin",SERVER_PUBLISH_SUCCESS:"server_publish_success",SERVER_PUBLISH_FAIL:"server_publish_fail",SERVER_RECEIVER_BEGIN:"server_receiver_begin",SERVER_RECEIVER_PUBLISH_BEGIN:"server_receiver_publish_begin",SERVER_SENTRY_RESTRICTION:"server_sentry_restriction"})}),null);
__d("PhotosUploadWaterfallXMixin",["AsyncSignal","Banzai","PhotosUploadWaterfallXConfig","invariant","randomInt"],(function(a,b,c,d,e,f,g,h,i,j,k){__p&&__p();var l=new Map();function m(a,b){var c={};a.client_time=Math.round(Date.now()/1e3);i.retryBanzai&&(c.retry=!0,a.nonce=k(4294967296));h.post(i.banzaiRoute,a,c);b&&setTimeout(b,0)}function n(a,b){if(i.useBanzai)m(a,b);else{a=new g(i.loggingEndpoint,{data:JSON.stringify(a)}).setHandler(b);i.timeout&&a.setTimeout(10*1e3);a.send()}}e.exports={logStep:function(a,b,c){var d=this.getWaterfallID&&this.getWaterfallID(),e=this.getWaterfallAppName&&this.getWaterfallAppName();if(!d||!e)return;n(babelHelpers["extends"]({step:a,qn:d,uploader:e,ref:this.getWaterfallSource&&this.getWaterfallSource()},b),c)},logPUWStep:function(a,b,c,d,e,f,g){if(f&&f.logOncePerSession){l.has(b)||l.set(b,new Set());if(l.get(b).has(a))return;l.get(b).add(a)}n(Object.assign({step:a,qn:b,uploader:c,ref:d},e),g)}}}),null);
__d("base64toUint8Array",[],(function(a,b,c,d,e,f){function a(a){a=atob(a);var b=a.length,c=new Uint8Array(b);for(var d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}e.exports=a}),null);
__d("DataViewPolyfill",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function b(a,b,c){b===undefined?this.$1=new Uint8Array(a):c===undefined?this.$1=new Uint8Array(a,b):this.$1=new Uint8Array(a,b,c),this.byteLength=this.$1.byteLength}b.prototype.getUint8=function(a){if(a>=this.$1.length)throw new Error("Trying to read beyond bounds of DataViewPolyfill");return this.$1[a]};b.prototype.getUint16=function(a,b){var c=this.getUint8(a);a=this.getUint8(a+1);return b?a*256+c:c*256+a};b.prototype.getUint32=function(a,b){var c=this.getUint8(a),d=this.getUint8(a+1),e=this.getUint8(a+2);a=this.getUint8(a+3);return b?((a*256+e)*256+d)*256+c:((c*256+d)*256+e)*256+a};b.isSupported=function(){return!!a.Uint8Array};e.exports=b}),null);
__d("getExifOrientation",["DataViewPolyfill"],(function(a,b,c,d,e,f,g){__p&&__p();var h=a.DataView||g;function b(a,b){__p&&__p();var c=new FileReader();c.onload=function(a){__p&&__p();var c="Exif\0\0",d=0,e;a=new h(a.target.result);for(var f=0;f<250;f++)if(a.getUint8(f)===c.charCodeAt(d)){d+=1;e=f+1;if(d===c.length)break}else d=0;if(!d){b(null);return}if(a.getUint8(e)==77&&a.getUint8(e+1)==77)f=!1;else if(a.getUint8(e)==73&&a.getUint8(e+1)==73)f=!0;else{b(null);return}e+=2;e+=2;var g;c=a.getUint32(e,f);e+=c-8+4;d=a.getUint16(e,f);e+=2;for(var c=0;c<Math.min(25,d);c++){g=a.getUint16(e,f);e+=8;if(g==274){g=a.getUint16(e,f);b(g);return}e+=4}b(null)};c.readAsArrayBuffer(a)}e.exports=b}),null);
__d("MPhotoResizer",["MegaPixImage","PhotosUploadWaterfallXMixin","PUWSteps","Vector","base64toUint8Array","getExifOrientation","invariant","mixin","performanceNow","requestAnimationFrame"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q,r="data:image/jpeg;base64,";b=babelHelpers.inherits(a,n(h));q=b&&b.prototype;function a(){"use strict";q.constructor.call(this),this.$MPhotoResizer1=new j(960,960),this.$MPhotoResizer2=.85}a.prototype.setFile=function(a){"use strict";this.$MPhotoResizer3=a;return this};a.prototype.setDimensions=function(a){"use strict";this.$MPhotoResizer1=a;return this};a.prototype.setQuality=function(a){"use strict";this.$MPhotoResizer2=a;return this};a.prototype.setHandler=function(a){"use strict";this.$MPhotoResizer4=a;return this};a.prototype.setWaterfall=function(a,b,c){"use strict";this.$MPhotoResizer5=a;this.$MPhotoResizer6=b;this.$MPhotoResizer7=c;return this};a.prototype.resize=function(){"use strict";__p&&__p();this.$MPhotoResizer3||m(0,3432);this.$MPhotoResizer1||m(0,3433);this.$MPhotoResizer2||m(0,3434);this.$MPhotoResizer4||m(0,3435);this.$MPhotoResizer5||m(0,3436);this.$MPhotoResizer6||m(0,3437);if(!g.isSupported){this.logStep(i.CLIENT_PROCESS_UNAVAILABLE,{error:"canvas_not_supported"});this.$MPhotoResizer4(this.$MPhotoResizer3);return}if(!this.$MPhotoResizer8()){this.logStep(i.CLIENT_PROCESS_UNAVAILABLE,{error:"no_jpeg_output"});this.$MPhotoResizer4(this.$MPhotoResizer3);return}this.logStep(i.CLIENT_PROCESS_BEGIN);var a=o();l(this.$MPhotoResizer3,function(b){__p&&__p();p(function(){__p&&__p();var c=document.createElement("canvas"),d=new g(this.$MPhotoResizer3);d.onrender=function(){__p&&__p();p(function(){var b=c.toDataURL("image/jpeg",this.$MPhotoResizer2);c=null;b=b.substr(r.length);p(function(){var c=k(b);b=null;c=new Blob([c.buffer],{type:"image/jpeg"});this.logStep(i.CLIENT_PROCESS_SUCCESS,{timeResizing:o()-a,originalSize:this.$MPhotoResizer3&&this.$MPhotoResizer3.size,resizedSize:c&&c.size});this.$MPhotoResizer4(c)}.bind(this))}.bind(this))}.bind(this);d.render(c,{maxWidth:this.$MPhotoResizer1.x,maxHeight:this.$MPhotoResizer1.y,orientation:b})}.bind(this))}.bind(this))};a.prototype.$MPhotoResizer8=function(){"use strict";var a=document.createElement("canvas");a.width=1;a.height=1;a=a.toDataURL("image/jpeg");return a.substr(0,r.length)===r};a.prototype.getWaterfallID=function(){"use strict";return this.$MPhotoResizer5};a.prototype.getWaterfallAppName=function(){"use strict";return this.$MPhotoResizer6};a.prototype.getWaterfallSource=function(){"use strict";return this.$MPhotoResizer7};e.exports=a}),null);
__d("XMobilePhotosSaveUnpublishedController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/_mupload_/photo/x/saveunpublished/",{allow_spherical_photo:{type:"Bool",defaultValue:!1},thumbnail_width:{type:"Int"},thumbnail_height:{type:"Int"},waterfall_app_name:{type:"String"},waterfall_id:{type:"String"},waterfall_source:{type:"String"},filter_type:{type:"Int"},use_autoenhance:{type:"Exists",defaultValue:!1},upload_id:{type:"String"},target_id:{type:"Int"},csid:{type:"String"},js_request_module_name:{type:"String"}})}),null);
__d("supportsXHR2",["memoize"],(function(a,b,c,d,e,f,g){function a(){if(!window.FormData||!window.XMLHttpRequest)return!1;var a=new XMLHttpRequest();return"upload"in a&&"withCredentials"in a}e.exports=g(a)}),null);
__d("MPhotoUploadRequest",["ActorURI","CurrentUser","DOM","MPhotoResizer","MRequest","PhotosUploadWaterfallXMixin","PUWSteps","Vector","XMobilePhotosSaveUnpublishedController","invariant","mixin","performanceNow","qex","supportsXHR2"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){__p&&__p();var u;b=babelHelpers.inherits(a,q(l));u=b&&b.prototype;function a(){"use strict";u.constructor.call(this),this.$MPhotoUploadRequest1=0}a.prototype.setClonedFileInput=function(a){"use strict";this.$MPhotoUploadRequest2=a;return this};a.prototype.setAttachedFile=function(a){"use strict";this.$MPhotoUploadRequest3=a;return this};a.prototype.setDTSG=function(a){"use strict";this.$MPhotoUploadRequest4=a;return this};a.prototype.setUploadDomain=function(a){"use strict";this.$MPhotoUploadRequest5=a;return this};a.prototype.setWaterfall=function(a,b,c){"use strict";this.$MPhotoUploadRequest6=a;this.$MPhotoUploadRequest7=b;this.$MPhotoUploadRequest8=c;return this};a.prototype.setHandler=function(a){"use strict";this.$MPhotoUploadRequest9=a;return this};a.prototype.setProgressHandler=function(a){"use strict";this.$MPhotoUploadRequest10=a;return this};a.prototype.setErrorHandler=function(a){"use strict";this.$MPhotoUploadRequest11=a;return this};a.prototype.setThumbnailDimensions=function(a){"use strict";this.$MPhotoUploadRequest12=a;return this};a.prototype.setResizeType=function(a){"use strict";this.$MPhotoUploadRequest13=a;return this};a.prototype.setTargetID=function(a){"use strict";this.$MPhotoUploadRequest14=a;return this};a.prototype.setActorID=function(a){"use strict";this.$MPhotoUploadRequest15=a;return this};a.prototype.setAllowSphericalPhoto=function(a){"use strict";this.$MPhotoUploadRequest16=a;return this};a.prototype.setJpegResizer=function(a){"use strict";return this};a.prototype.send=function(){"use strict";__p&&__p();this.$MPhotoUploadRequest2||p(0,801);this.$MPhotoUploadRequest5||p(0,802);this.$MPhotoUploadRequest4||p(0,803);this.$MPhotoUploadRequest6||p(0,804);this.$MPhotoUploadRequest7||p(0,805);this.$MPhotoUploadRequest8||p(0,806);this.$MPhotoUploadRequest9||p(0,807);this.$MPhotoUploadRequest12||p(0,808);!this.$MPhotoUploadRequest17&&!this.$MPhotoUploadRequest18||p(0,809);!t()?this.$MPhotoUploadRequest19():this.$MPhotoUploadRequest20();return this};a.prototype.$MPhotoUploadRequest21=function(a,b){"use strict";this.logStep(a,babelHelpers["extends"]({retriesNeeded:this.$MPhotoUploadRequest1},b||{}))};a.prototype.abort=function(a){"use strict";if(!this.$MPhotoUploadRequest2)return;this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_CANCEL,{elapsed_time:r()-this.transferStartTime,bytes:this.fileSize,progress:a});t()?this.$MPhotoUploadRequest22():this.$MPhotoUploadRequest23()};a.prototype.retry=function(){"use strict";this.$MPhotoUploadRequest1++,this.abort(),this.send()};a.prototype.$MPhotoUploadRequest24=function(){"use strict";var a=this.$MPhotoUploadRequest2.files;return a&&a.item&&a.item(0)&&a.item(0).size};a.prototype.$MPhotoUploadRequest25=function(){"use strict";var a=o.getURIBuilder().setBool("allow_spherical_photo",this.$MPhotoUploadRequest16).setInt("thumbnail_width",this.$MPhotoUploadRequest12.x).setInt("thumbnail_height",this.$MPhotoUploadRequest12.y).setString("waterfall_id",this.$MPhotoUploadRequest6).setString("waterfall_app_name",this.$MPhotoUploadRequest7).setString("waterfall_source",this.$MPhotoUploadRequest8).setInt("target_id",this.$MPhotoUploadRequest14).getURI().setProtocol(this.$MPhotoUploadRequest5.getProtocol()).setDomain(this.$MPhotoUploadRequest5.getDomain());return g.create(a,this.$MPhotoUploadRequest15)};a.prototype.$MPhotoUploadRequest20=function(){"use strict";var a=this.$MPhotoUploadRequest3,b=this.$MPhotoUploadRequest13||"no_resize";if(a&&b=="canvas_resize"){b=s._("697678");new j().setFile(a).setWaterfall(this.$MPhotoUploadRequest6,this.$MPhotoUploadRequest7,this.$MPhotoUploadRequest8).setHandler(function(a){this.$MPhotoUploadRequest26(a)}.bind(this)).setDimensions(new n(b,b)).resize()}else this.$MPhotoUploadRequest26(a)};a.prototype.$MPhotoUploadRequest26=function(a){"use strict";__p&&__p();var b=new FormData();b.append(this.$MPhotoUploadRequest2.name,a);this.fileSize=a.size;this.transferStartTime=r();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_BEGIN,{bytes:this.fileSize});a=this.$MPhotoUploadRequest17=new k(this.$MPhotoUploadRequest25()).setCORS(!0).setData({fb_dtsg:this.$MPhotoUploadRequest4}).setRawData(b);a.listen("open",function(a){a=a.getTransport();a.withCredentials=!0});a.listen("done",function(a){this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_SUCCESS,{elapsed_time:r()-this.transferStartTime,bytes:this.fileSize,fbid:a.fbid}),this.$MPhotoUploadRequest9(a)}.bind(this));a.listen("error",function(a){this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_FAIL,{error_type:"mrequest_fail",elapsed_time:r()-this.transferStartTime,bytes:this.fileSize}),this.$MPhotoUploadRequest11&&this.$MPhotoUploadRequest11(a)}.bind(this));a.listen("uploadprogress",function(a){this.$MPhotoUploadRequest10&&this.$MPhotoUploadRequest10(a)}.bind(this));a.send()};a.prototype.$MPhotoUploadRequest22=function(){"use strict";this.$MPhotoUploadRequest17&&this.$MPhotoUploadRequest17.abort(),this.$MPhotoUploadRequest17=null};a.prototype.$MPhotoUploadRequest27=function(a,b){"use strict";return i.create("input",{type:"hidden",name:a,value:b})};a.prototype.$MPhotoUploadRequest19=function(){"use strict";__p&&__p();var a="MPhotoUpload"+v++,b=this.$MPhotoUploadRequest18=i.create("iframe",{name:a,id:a});b.style.display="none";var c=this.$MPhotoUploadRequest28=i.create("form",{target:a,action:this.$MPhotoUploadRequest25().toString(),method:"POST",enctype:"multipart/form-data"});c.style.display="none";var d={fb_dtsg:this.$MPhotoUploadRequest4,__a:1,__user:h.getID(),upload_id:a};for(var e in d)i.appendContent(c,this.$MPhotoUploadRequest27(e,d[e]));i.appendContent(document.body,b);i.appendContent(document.body,c);i.appendContent(c,this.$MPhotoUploadRequest2);this.fileSize=this.$MPhotoUploadRequest24();w[a]=function(b){if(!b){this.$MPhotoUploadRequest29("no_payload");return}delete w[a];this.$MPhotoUploadRequest23();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_SUCCESS,{elapsed_time:r()-this.transferStartTime,bytes:this.fileSize,fbid:b.fbid});this.$MPhotoUploadRequest9(b)}.bind(this);b.onerror=this.$MPhotoUploadRequest29.bind("iframe_onerror");this.transferStartTime=r();this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_BEGIN,{bytes:this.fileSize});d=window.location.hostname.match(/\.(facebook\.sg|facebookcorewwwi\.onion)$/);document.domain=d?d[1]:"facebook.com";c.submit()};a.prototype.$MPhotoUploadRequest29=function(a){"use strict";this.$MPhotoUploadRequest21(m.CLIENT_TRANSFER_FAIL,{error_type:a,elapsed_time:r()-this.transferStartTime,bytes:this.fileSize}),this.$MPhotoUploadRequest11&&this.$MPhotoUploadRequest11(),this.$MPhotoUploadRequest23()};a.prototype.$MPhotoUploadRequest23=function(){"use strict";this.$MPhotoUploadRequest18&&i.remove(this.$MPhotoUploadRequest18),this.$MPhotoUploadRequest18=null,this.$MPhotoUploadRequest28&&i.remove(this.$MPhotoUploadRequest28),this.$MPhotoUploadRequest28=null};a.prototype.getWaterfallID=function(){"use strict";return this.$MPhotoUploadRequest6};a.prototype.getWaterfallAppName=function(){"use strict";return this.$MPhotoUploadRequest7};a.prototype.getWaterfallSource=function(){"use strict";return this.$MPhotoUploadRequest8};a.handleResponse=function(a,b){"use strict";w[a](b)};var v=0,w={};e.exports=a}),null);
__d("MGraphApiVideoUploader",["FBJSON","URI","UrlMap","ZeroUploadSubdomainModule"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=10;function a(a,b,c,d,e,f,g){"use strict";this.$1=a,this.$3=b,this.$2=c,this.$13=d,this.$6=this.$1.size,this.$7=this.$1.name,this.$8=e,this.$9=f,this.$10=g,this.$11=!1}a.prototype.startUploading=function(a){__p&&__p();a===void 0&&(a=k);var b=new FormData();b.append("file_size",this.$6);b.append("title",this.$7);b.append("upload_phase","start");b.append("access_token",this.$3);this.$13&&b.append("is_voice_clip",this.$13);var c=function(b){if(this.$11)return;if(!b||b.error){a==0?this.$9(b.error.error_user_msg):this.startUploading(a-1);return}this.$4=b.upload_session_id;this.$5=b.video_id;this.sendFileChunk(b.start_offset,b.end_offset,k)}.bind(this);this.postRequest("v2.4/"+this.$2+"/videos","POST",b,k,c)};a.prototype.getChunk=function(a,b){"use strict";return this.$1.slice(a,b)};a.prototype.sendFileChunk=function(a,b,c){__p&&__p();c===void 0&&(c=k);if(this.$11)return;var d=new FormData();d.append("upload_phase","transfer");d.append("start_offset",a);d.append("upload_session_id",this.$4);d.append("access_token",this.$3);d.append("video_file_chunk",this.getChunk(a,b));var e=function(d){__p&&__p();if(this.$11)return;if(!d||d.error){if(c==0){this.$9(d.error.error_user_msg);return}else this.sendFileChunk(a,b,c-1);return}this.$14(d)}.bind(this),f=this.$8&&function(c){var d=parseInt(a,10),e=parseInt(b,10);c=c.loaded/c.total;e=e-d;this.$8(Math.floor(d+c*e))}.bind(this);this.postRequest("v2.4/"+this.$2+"/videos","POST",d,k,e,f)};a.prototype.$14=function(a){"use strict";a.start_offset!=a.end_offset?this.sendFileChunk(a.start_offset,a.end_offset,k):this.$9(!0)};a.prototype.postRequest=function(a,b,c,d,e,f){"use strict";__p&&__p();var l=i.resolve("graph")+"/"+a,m=j.subdomain;m!==""&&(l=new h(l).setSubdomain(m).toString());c.pretty=c.pretty||0;this.$12=new XMLHttpRequest();this.$12.onload=function(){var a=g.parse(this.$12.responseText);e(a)}.bind(this);f&&(this.$12.upload.onprogress=f);this.$12.onerror=function(){if(d==0){this.$10!==null&&this.$10();return}setTimeout(function(){this.postRequest(a,b,c,d-1,e)}.bind(this),1e3*Math.pow(2,k-d))}.bind(this);this.$12.open("post",l);this.$12.send(c)};a.prototype.getVideoID=function(){"use strict";return this.$5};a.prototype.abort=function(){"use strict";this.$11=!0,this.$12!==null&&this.$12.abort()};e.exports=a}),null);
__d("MVideoUploadRequest",["MGraphApiVideoUploader","PhotosUploadWaterfallXMixin","PUWSteps","invariant","mixin","performanceNow"],(function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";__p&&__p();var m;b=babelHelpers.inherits(a,k(h));m=b&&b.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=m.constructor).call.apply(a,[this].concat(d)),this.$MVideoUploadRequest18=!1,b}a.prototype.setClonedFileInput=function(a){this.$MVideoUploadRequest2=a;return this};a.prototype.setWaterfall=function(a,b,c){this.$MVideoUploadRequest6=a;this.$MVideoUploadRequest7=b;this.$MVideoUploadRequest8=c;return this};a.prototype.setHandler=function(a){this.$MVideoUploadRequest9=a;return this};a.prototype.setProgressHandler=function(a){this.$MVideoUploadRequest10=a;return this};a.prototype.setErrorHandler=function(a){this.$MVideoUploadRequest11=a;return this};a.prototype.setThumbnailDimensions=function(a){this.$MVideoUploadRequest12=a;return this};a.prototype.setTargetID=function(a){this.$MVideoUploadRequest13=a;return this};a.prototype.setActorID=function(a){this.$MVideoUploadRequest14=a;return this};a.prototype.setAccessToken=function(a){this.$MVideoUploadRequest15=a;return this};a.prototype.setFileIndex=function(a){this.$MVideoUploadRequest17=a;return this};a.prototype.setIsVoiceClip=function(){this.$MVideoUploadRequest18=!0;return this};a.prototype.getFile=function(){return this.$MVideoUploadRequest2.files[this.$MVideoUploadRequest17]};a.prototype.send=function(){__p&&__p();this.$MVideoUploadRequest2||j(0,801);this.$MVideoUploadRequest9||j(0,807);this.$MVideoUploadRequest16&&j(0,809);this.$MVideoUploadRequest16=new g(this.getFile(),this.$MVideoUploadRequest15,this.$MVideoUploadRequest13,this.$MVideoUploadRequest18,function(a){return this.$MVideoUploadRequest10({loaded:a,total:this.$MVideoUploadRequest19()})}.bind(this),function(){return this.$MVideoUploadRequest9({fbid:this.$MVideoUploadRequest16.getVideoID()})}.bind(this),function(){var a=this.$MVideoUploadRequest11;a!==null&&a!==undefined&&a({fbid:this.$MVideoUploadRequest16.getVideoID()})}.bind(this));this.$MVideoUploadRequest16.startUploading();return this};a.prototype.$MVideoUploadRequest20=function(a,b){this.logStep(a,babelHelpers["extends"]({retriesNeeded:this.$MVideoUploadRequest1},b||{}))};a.prototype.abort=function(a){if(!this.$MVideoUploadRequest2)return;this.$MVideoUploadRequest16&&this.$MVideoUploadRequest16.abort();this.$MVideoUploadRequest16=null;this.$MVideoUploadRequest20(i.CLIENT_TRANSFER_CANCEL,{elapsed_time:l()-this.transferStartTime,bytes:this.fileSize,progress:a})};a.prototype.retry=function(){this.$MVideoUploadRequest1++,this.abort(),this.send()};a.prototype.$MVideoUploadRequest19=function(){var a=this.getFile();return a&&a.size};a.prototype.getWaterfallID=function(){return this.$MVideoUploadRequest6};a.prototype.getWaterfallAppName=function(){return this.$MVideoUploadRequest7};a.prototype.getWaterfallSource=function(){return this.$MVideoUploadRequest8};e.exports=a}),null);
__d("MMultiPhotoUploader.react",["ix","Bootloader","Event","Image.react","MAudioPost.react","MLoadingIndicator.react","MMultiPhotoUploaderAttachment.react","MMultiPhotoUploaderAttachmentState","MMultiPhotoUploaderAttachmentType","MMultiPhotoUploaderHiddenInputs.react","MMultiPhotoUploaderPlusAttachment.react","MPhotoUploadDisable","MPhotoUploadFileInput","MPhotoUploadRequest","MSphericalPhotoConfig","MVideoUploadRequest","PhotosUploadWaterfallXMixin","PUWSteps","React","ReactDOM","Stratcom","URI","Vector","asset","cx","fbt","forEachObject","intlNumUtils","qex","throttle"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J){__p&&__p();a=y.PropTypes;var K=0,L=80,M=56,N;b=y.createClass({displayName:"MMultiPhotoUploader",_pendingUploadRequests:{},propTypes:{dtsg:a.string.isRequired,fileInput:a.instanceOf(s).isRequired,videoFileInput:a.instanceOf(s),formHiddenInputs:a.instanceOf(HTMLElement).isRequired,uploadDomain:a.instanceOf(B).isRequired,allowVideo:a.bool.isRequired,useLocalFilePreview:a.bool.isRequired,separatePhotoAndVideo:a.bool.isRequired,waterfallID:a.string.isRequired,waterfallAppName:a.string.isRequired,waterfallSource:a.string.isRequired,actorID:a.string,targetID:a.string,maxPhotosAllowed:a.number,initCollapsed:a.bool,logFlowBeginOnClick:a.bool,shouldScroll:a.bool,shouldShowLargeThumbnails:a.bool,shouldShowWhiteDesign:a.bool,shouldShowAddPhotoLabel:a.bool,showDropShadow:a.bool,disableIOS8SafariAlert:a.bool,accessToken:a.string,hideUploadProgress:a.bool,onUploadSuccess:a.func,onRemove:a.func,onThumbnailClicked:a.func,onUploadStarted:a.func,startPollingTagSuggestionsCallback:a.func,initialPhotos:a.array},mixins:[w],audioUploadListener:null,audioSrc:null,setCollapsed:function(a){this.setState({collapsed:a})},isCollapsed:function(){return this.state.collapsed},allowSingleAttachment:function(){return+this.props.maxPhotosAllowed===1},getAttachmentCount:function(){return this.attachments.length},hasAttachments:function(){return this.attachments.length>0},hasVideos:function(){return this.state.attachments.filter(function(a){return a.state===n.UPLOADED&&a.type===o.VIDEO}).length>0},clearAttachments:function(){this.setAttachments(this.attachments.filter(function(a){a.state===n.SENDING&&a.request.abort();return!1}))},getInitialState:function(){__p&&__p();var a=this.props.initialPhotos;if(a!==null){for(var b=0;b<a.length;b++)a[b].id=K++,a[b].state=n.UPLOADED;b={};b[n.UPLOADED]=a.length;A.invoke("MMultiPhotoUploader:attachments:change",null,b)}this.attachments=a?a:[];this._throttledProgressUpdate=J.acrossTransitions(this._invokeProgressUpdate,400,this);return{attachments:this.attachments,collapsed:this.props.initCollapsed}},numAttachmentsWithState:function(a){return this.attachments.filter(function(b){return b.state===a}).length},numAttachmentsOfType:function(a){return this.attachments.filter(function(b){return b.type===a}).length},isMaxAttachmentReached:function(){return this.attachments.length>=this.props.maxPhotosAllowed},setAttachments:function(a){A.invoke("multi-photos-attachment-change",null,{attachments:a,multiPhotoUploader:this}),this.setAttachmentsSilent(a)},setAttachmentsSilent:function(a){__p&&__p();this.attachments=a;this.setState({attachments:a});a=this.props.fileInput.getDOMElement();a.disabled=this.isMaxAttachmentReached();A.invoke("multi-photos-change",null,{input_id:a.id});a={input_id:a.id};for(var b in n){if(!Object.prototype.hasOwnProperty.call(n,b)||typeof n[b]!=="string")continue;var c=n[b];a[c]=this.numAttachmentsWithState(c)}A.invoke("MMultiPhotoUploader:attachments:change",null,a)},addAttachment:function(a){A.invoke("MMultiPhotoUploader:attachments:add",null,{photo_count:a.length||1}),this.setAttachments(this.attachments.concat([a]))},removeAttachment:function(a){__p&&__p();A.invoke("MMultiPhotoUploader:attachments:remove",null,{photo_count:1}),this.setAttachments(this.attachments.filter(function(b){__p&&__p();if(b.id===a){if(b.state===n.SENDING){var c=0;b.totalSize&&(c=Math.floor(100*(b.loaded/b.totalSize)));b.request.abort(c)}else this.logStep(x.CLIENT_UPLOAD_REMOVE,{fbid:b.fbid});b.fbid&&(this.props.onRemove&&this.props.onRemove(b.fbid));return!1}return!0}.bind(this)))},updateAttachment:function(a){this.setAttachments(this.attachments.map(function(b){return b.id===a.id?a:b}))},getAttachment:function(a){return this.attachments.filter(function(b){return b.id===a})[0]},setAttachmentProps:function(a,b){a=this.getAttachment(a);var c={};for(var d in a)c[d]=a[d];for(d in b)c[d]=b[d];this.updateAttachment(c)},retryAttachment:function(a){var b=this.getAttachment(a);this.logStep(x.CLIENT_ATTEMPT_RETRY,{fbid:b.fbid});b.request.retry();this.updateAttachment({id:a,state:"sending",request:b.request,isSpherical:b.isSpherical,type:b.type,fileImageURI:b.fileImageURI})},setAttachmentTagCounts:function(a){this.setAttachmentsSilent(this.attachments.map(function(b){b.tagCount=a[b.id];return b}))},componentDidMount:function(){this.props.fileInput.setChangeHandler(this.onFileInputChange),this.props.fileInput.setClickHandler(this.onFileInputClick),this.props.videoFileInput&&(this.props.videoFileInput.setChangeHandler(this.onVideoFileInputChange),this.props.videoFileInput.setClickHandler(this.onVideoFileInputClick)),!this.hasAttachments()&&!this.props.logFlowBeginOnClick&&this.logStep(x.CLIENT_FLOW_BEGIN),this.renderHiddenInputs(),this.resizeAndScroll(),this.audioUploadListener=A.listen("MAudioRecorder:upload",null,function(event){var a=event.getData().blob,b=event.getData().audioSrc;this.uploadAudio(a,b)}.bind(this))},componentWillUnmount:function(){z.unmountComponentAtNode(this.props.formHiddenInputs),this.props.fileInput.setChangeHandler(null),this.props.fileInput.setClickHandler(null),this.props.videoFileInput&&(this.props.videoFileInput.setChangeHandler(null),this.props.videoFileInput.setClickHandler(null)),G(this._pendingUploadRequests,function(a){return a.abort()}),delete this._pendingUploadRequests,this.audioUploadListener&&this.audioUploadListener.remove()},onFileInputChange:function(){var a=this.props.fileInput.getDOMElement();A.invoke("MMultiPhotoUploader:input:change",null,{input:a});this.uploadAttachments(this.props.fileInput)},onVideoFileInputChange:function(){var a=this.props.videoFileInput.getDOMElement();A.invoke("MMultiPhotoUploader:input:change",null,{input:a});this.uploadAttachments(this.props.videoFileInput)},onFileInputClick:function(event){this.props.disableIOS8SafariAlert===!0&&r.alertIOS8FileUploadDisabled(event),!this.hasAttachments()&&this.props.logFlowBeginOnClick&&this.logStep(x.CLIENT_FLOW_BEGIN),this.logStep(x.CLIENT_SELECT_BEGIN),A.invoke("MMultiPhotoUploader:input:click",null,{input:this.props.fileInput.getDOMElement()})},onVideoFileInputClick:function(event){this.props.disableIOS8SafariAlert===!0&&r.alertIOS8FileUploadDisabled(event),!this.hasAttachments()&&this.props.logFlowBeginOnClick&&this.logStep(x.CLIENT_FLOW_BEGIN),this.logStep(x.CLIENT_SELECT_BEGIN),A.invoke("MMultiPhotoUploader:input:click",null,{input:this.props.videoFileInput.getDOMElement()})},uploadAttachments:function(a){__p&&__p();var b=this,c=a.getDOMElement().files;if(c.length===0){this.logStep(x.CLIENT_SELECT_FAIL);return}var d=a.cloneDOMNode();a=this.props.maxPhotosAllowed>c.length?c.length:this.props.maxPhotosAllowed;a<c.length&&window.alert(F._("N\u00famero excessivo de fotos adicionadas. Voc\u00ea s\u00f3 pode adicionar {maxPhotosAllowed} fotos a uma publica\u00e7\u00e3o. Para adicionar mais fotos, crie um \u00e1lbum.",[F._param("maxPhotosAllowed",this.props.maxPhotosAllowed)]));var e=function(a){__p&&__p();var e=c[a];if(e.name===""&&e.fileName===""&&e.size===0&&e.fileSize===0){b.logStep(x.CLIENT_SELECT_FAIL);return"continue"}b.logStep(x.CLIENT_SELECT_SUCCESS);if(e.type.match("image.*")){var f=I._("697677")?"canvas_resize":"no_resize",g=K++;f=new t().setAllowSphericalPhoto(!0).setAttachedFile(e).setDTSG(b.props.dtsg).setUploadDomain(b.props.uploadDomain).setResizeType(f);b.uploadAttachment(f,d,g,o.PHOTO,e.size,b.props.useLocalFilePreview?URL.createObjectURL(e):null);u.is_mtouch_basic_uploader_on&&h.loadModules(["SphericalImage"],function(a){a.createFromBlob(e).then(function(a){return this.handleSphericalPhotoCheck(g,a)}.bind(this))["catch"](function(a){}).done()}.bind(b),"MMultiPhotoUploader.react")}else if(e.type.match("video.*")&&b.props.allowVideo){var i=K++;f=new v().setAccessToken(b.props.accessToken).setFileIndex(a);b.uploadAttachment(f,d,i,o.VIDEO,e.size,null);b.props.useLocalFilePreview&&b.getVideoThumbnail(e,function(a){this.updateFileImageURI(i,a)}.bind(b))}};for(var f=0;f<a;f++){var g=e(f);if(g==="continue")continue}},uploadAttachment:function(a,b,c,d,e,f){var g=this.props.shouldShowLargeThumbnails?L:M,h=this.props,i=h.targetID;h=h.actorID;a=a.setClonedFileInput(b).setThumbnailDimensions(new C(g,g)).setWaterfall(this.props.waterfallID,this.props.waterfallAppName,this.props.waterfallSource).setHandler(this.handleUploadSuccess.bind(this,c)).setErrorHandler(this.handleUploadError.bind(this,c)).setProgressHandler(this.handleUploadProgress.bind(this,c)).setTargetID(i&&H.parseNumber(i)).setActorID(h&&H.parseNumber(h)).send();this._pendingUploadRequests[c]=a;this.props.onUploadStarted&&this.props.onUploadStarted();this.allowSingleAttachment()&&this.clearAttachments();this.addAttachment({id:c,state:"sending",type:d,request:a,fileImageURI:f,loaded:0,totalSize:e});this.setCollapsed(!1)},handleSphericalPhotoCheck:function(a,b){a=this.getAttachment(a);this.updateAttachment(babelHelpers["extends"]({},a,{isSpherical:b&&b.isSpherical()}))},updateFileImageURI:function(a,b){a=this.getAttachment(a);this.updateAttachment(babelHelpers["extends"]({},a,{fileImageURI:b}))},handleUploadError:function(a){delete this._pendingUploadRequests[a];var b=this.getAttachment(a);this.updateAttachment({id:a,state:"error",request:b.request,isSpherical:b.isSpherical,type:b.type,fileImageURI:b.fileImageURI})},handleUploadProgress:function(a,b){var c=this.getAttachment(a);this.updateAttachment({id:a,state:c.state,request:c.request,loaded:b.loaded,totalSize:b.total,isSpherical:c.isSpherical,type:c.type,fileImageURI:c.fileImageURI});this._throttledProgressUpdate()},_invokeProgressUpdate:function(){var a=function(a,b){return a+b},b=this.attachments.map(function(a){return a.totalSize}).reduce(a);a=this.attachments.map(function(a){return a.loaded}).reduce(a);A.invoke("MMultiPhotoUploader:upload:progress",null,{totalLoaded:a,totalSize:b})},handleUploadSuccess:function(a,b){delete this._pendingUploadRequests[a];if(!b.fbid){this.handleUploadError(a);return}var c=this.getAttachment(a),d=c.type===o.PHOTO&&this.props.startPollingTagSuggestionsCallback?n.POLLING_TAG_SUGGESTIONS:n.UPLOADED;this.updateAttachment({id:a,state:d,fbid:b.fbid,imageURI:b.thumbnail_uri,thumbnail_width:b.thumbnail_width,thumbnail_height:b.thumbnail_height,loaded:c.loaded,totalSize:c.totalSize,previewURI:b.preview_uri,isSpherical:c.isSpherical,type:c.type,fileImageURI:c.fileImageURI});this.props.onUploadSuccess&&this.props.onUploadSuccess(b.fbid,a);d===n.POLLING_TAG_SUGGESTIONS&&this.props.startPollingTagSuggestionsCallback(b.fbid,a)},onPhotoPlusClick:function(event){this.props.fileInput.click(event)},onVideoPlusClick:function(event){this.props.videoFileInput&&this.props.videoFileInput.click(event)},onRemoveClick:function(a){var b=this.getAttachment(a),c=!1;(b.state===n.SENDING||b.state===n.ERROR)&&(c=confirm(F._("Esta foto n\u00e3o foi carregada. Deseja tentar novamente?")));c?this.retryAttachment(a):this.removeAttachment(a)},UNSAFE_componentWillUpdate:function(){this.props.shouldScroll&&this.refs&&this.refs.scroller&&this.refs.scroller.checkShouldScrollToEnd()},componentDidUpdate:function(){this.renderHiddenInputs(),this.resizeAndScroll()},renderHiddenInputs:function(){var a=this.state.attachments.filter(function(a){return(a.state===n.UPLOADED||a.state===n.POLLING_TAG_SUGGESTIONS)&&a.type===o.PHOTO}).map(function(a){return a.fbid}),b=this.state.attachments.filter(function(a){return a.state===n.UPLOADED&&(a.type===o.VIDEO||a.type===o.AUDIO)}).map(function(a){return a.fbid});z.render(y.createElement(p,babelHelpers["extends"]({},this.props,{photo_fbids:a,video_fbids:b})),this.props.formHiddenInputs)},resizeAndScroll:function(){this.props.shouldScroll&&this.refs&&this.refs.scroller&&(this.refs.scroller.resizeScroller(),this.refs.scroller.scrollHorizontallyToEnd())},getPlusAttachment:function(){if(this.allowSingleAttachment()&&this.state.collapsed)return null;if(this.isMaxAttachmentReached())return null;return this.props.separatePhotoAndVideo&&this.props.videoFileInput?y.createElement("span",null,y.createElement(q,{onClick:this.onPhotoPlusClick,largeThumbnails:this.props.shouldShowLargeThumbnails,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,shouldShowAddPhotoLabel:!0}),y.createElement(q,{onClick:this.onVideoPlusClick,largeThumbnails:this.props.shouldShowLargeThumbnails,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,shouldShowAddVideoLabel:!0})):y.createElement(q,{onClick:this.onPhotoPlusClick,largeThumbnails:this.props.shouldShowLargeThumbnails,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,shouldShowAddPhotoLabel:this.props.shouldShowAddPhotoLabel})},adjustScroller:function(){this.props.shouldScroll&&this.refs&&this.refs.scroller&&(this.refs.scroller.checkShouldScrollToEnd(),this.refs.scroller.resizeScroller(),this.refs.scroller.scrollHorizontallyToEnd())},getVideoThumbnail:function(a,b){__p&&__p();var c=new FileReader();c.onload=function(){__p&&__p();var d=new Blob([c.result],{type:a.type});d=URL.createObjectURL(d);var e=document.createElement("video"),f=function a(){g()&&(e.removeEventListener("timeupdate",a),e.pause())};i.listen(e,"loadeddata",function(){var a=g();a&&e.removeEventListener("timeupdate",f);b(a)});var g=function(){var a=document.createElement("canvas");a.width=e.videoWidth;a.height=e.videoHeight;a.getContext("2d").drawImage(e,0,0,a.width,a.height);a=a.toDataURL();var b=a.length>1e4;return b?a:null};i.listen(e,"timeupdate",f);e.preload="metadata";e.muted=!0;e.playsInline=!0;e.autoplay=!0;e.src=d};c.readAsArrayBuffer(a)},render:function(){__p&&__p();if(this.state.collapsed)return y.createElement("div",null);if(this.state.attachments.length>0&&this.state.attachments[0].type===o.AUDIO){var a=this.state.attachments[0];return y.createElement("div",{className:"_6psu"},a.request?y.createElement("div",{className:"_6ppq"},y.createElement(l,{className:"_6ppr"})):null,y.createElement(k,{videoSource:this.audioSrc,spinner:document.createElement("div")}),y.createElement("button",{onClick:function(){return this.onRemoveClick(a.id)}.bind(this),className:"_6pps"},y.createElement(j,{src:g("497564")})))}var b=this.state.attachments.map(function(a){var b=this.props.shouldShowLargeThumbnails?L:M;return y.createElement(m,babelHelpers["extends"]({},a,{key:a.id,shouldShowLargeThumbnails:this.props.shouldShowLargeThumbnails,previewSize:b,useLocalFilePreview:this.props.useLocalFilePreview,shouldShowWhiteDesign:this.props.shouldShowWhiteDesign,onRemoveClick:function(){this.onRemoveClick(a.id)}.bind(this),onPreviewLoaded:function(){this.adjustScroller()}.bind(this),loaded:a.loaded,totalSize:a.totalSize,hideUploadProgress:this.props.hideUploadProgress,onThumbnailClicked:function(){this.props.onThumbnailClicked&&this.props.onThumbnailClicked(a)}.bind(this)}))}.bind(this)),c=this.props.shouldScroll&&this.state.attachments.length>1;if(c)if(!N)h.loadModules(["MMultiPhotoUploaderSimpleScroller"],function(a){N=a,this.forceUpdate()}.bind(this),"MMultiPhotoUploader.react");else return y.createElement(N,{options:{scrollingY:!1},className:(this.props.shouldShowLargeThumbnails?"":"_1upb")+" _xy"+(this.props.showDropShadow?" _bgx":""),thumbnailSize:L,ref:"scroller"},b,this.getPlusAttachment());return y.createElement("div",{className:"_5cqb"+(c?" _2nym":"")},b,this.getPlusAttachment())},getWaterfallID:function(){return this.props.waterfallID},getWaterfallAppName:function(){return this.props.waterfallAppName},getWaterfallSource:function(){return this.props.waterfallSource},uploadAudio:function(a,b){var c=K++,d=new v().setAccessToken(this.props.accessToken).setIsVoiceClip().setFileIndex(0);this.audioSrc=b;b=new File([a],"UID"+c);this.uploadAttachment(d,{files:[b]},c,o.AUDIO,b.size,null);this.props.useLocalFilePreview&&this.getVideoThumbnail(a,function(a){this.updateFileImageURI(c,a)}.bind(this))}});e.exports=b}),null);
__d("MMultiPhotoUploaderInitReact",["DOM","MComposerBackgroundUploadProgress","MMultiPhotoUploader.react","MMultiPhotoUploaderAttachmentState","MPhotoUploadFileInput","PUWSteps","ReactComponentRenderer","Run","Stratcom","StratcomManager","SubscriptionsHandler","URI","$","ge"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){__p&&__p();var u="m-raw-file-input";function a(a,b){"use strict";__p&&__p();var c=a.previewGridElem||s(a.previewGridId),d=a.targetFormElem||s(a.targetFormId),e=a.inputId,f=a.inputContainerElem,j=a.containerClassName||null,v=null;if(f){f=g.scry(f,"input",u)[0];f&&f.id===e&&(v=f)}v=v||s(e);f=a.videoInputId?t(a.videoInputId):null;e=document.createElement("div");j!==null&&j.length!==0&&(e.className=j);g.insertBefore(c,e);j=document.createElement("div");g.appendContent(d,j);var w=new k(v);c=f?new k(f):null;this.$1=new m(i,e);this.$1.setProps({fileInput:w,videoFileInput:c,formHiddenInputs:j,uploadDomain:new r(a.uploadDomain),dtsg:a.dtsg,shouldResize:a.shouldResize,maxPhotosAllowed:a.maxPhotosAllowed,waterfallID:a.waterfallID,waterfallAppName:a.waterfallAppName,waterfallSource:a.waterfallSource,initCollapsed:a.initCollapsed,logFlowBeginOnClick:a.logFlowBeginOnClick,targetID:a.targetID,actorID:a.actorID,shouldScroll:a.horizontalScrolling,shouldShowLargeThumbnails:a.largeThumbnails,shouldShowWhiteDesign:a.useWhiteDesign,shouldShowAddPhotoLabel:a.showPhotoLabel,showDropShadow:a.composerDropShadow,disableIOS8SafariAlert:a.disableIOS8SafariAlert,initialPhotos:b,allowVideo:a.allowVideo,accessToken:a.accessToken,useLocalFilePreview:a.useLocalFilePreview,separatePhotoAndVideo:a.separatePhotoAndVideo,hideUploadProgress:a.hideUploadProgress});p.enableDispatch(window,"reset");var x=new q();x.addSubscriptions(o.listen("reset",["id:"+a.targetFormId],function(){this.resetState()}.bind(this)),o.listen("MActorSelector-actorChange",null,function(event){event.getData().targetID===a.targetID&&(this.resetState(),this.$1.setProps({actorID:event.getData().actorID,maxPhotosAllowed:event.getData().maxPhotosAllowed}))}.bind(this)),o.listen("MStructuredComposer-canceled",null,function(){this.$1.component.isCollapsed()||this.$1.component.logStep(l.CLIENT_FLOW_CANCEL,{volume:this.$1.component.getAttachmentCount()})}.bind(this)));n.onLeave(function(){if(h.isRunning())return;this.$1.unmount();w.destroy();x.release()}.bind(this))}a.prototype.logClientPost=function(a){"use strict";this.$1.component.logStep(l.CLIENT_FLOW_POST,{volume:this.$1.component.getAttachmentCount()},a)};a.prototype.alterPreviewGrid=function(a){"use strict";return this.$1.component.setCollapsed(!a)};a.prototype.getUploader=function(){"use strict";return this.$1};a.prototype.resetState=function(){"use strict";this.$1.component.clearAttachments();return this.alterPreviewGrid(!1)};a.prototype.hasPhotos=function(a){a===void 0&&(a=!1);return this.$1.component.numAttachmentsWithState(j.UPLOADED)>0||!h.isWaitingForTagSuggestions()&&this.hasPollingPhotos()||a&&this.hasPendingPhotos()};a.prototype.hasPendingPhotos=function(){"use strict";return this.$1.component.numAttachmentsWithState(j.SENDING)>0||h.isWaitingForTagSuggestions()&&this.hasPollingPhotos()};a.prototype.numAttachmentsOfType=function(a){"use strict";return this.$1.component.numAttachmentsOfType(a)};a.prototype.hasPollingPhotos=function(){"use strict";return this.$1.component.numAttachmentsWithState(j.POLLING_TAG_SUGGESTIONS)>0};a.prototype.getUploadedMediaCount=function(){"use strict";return this.$1.component.numAttachmentsWithState(j.UPLOADED)+this.$1.component.numAttachmentsWithState(j.POLLING_TAG_SUGGESTIONS)};a.prototype.getMediaCount=function(){"use strict";return this.$1.component.getAttachmentCount()};a.prototype.uploadPhotos=function(a){"use strict";this.$1.component.uploadPhotos(a)};e.exports=a}),null);
__d("AbstractCommentLiveTypingXHRController",["destroyOnUnload","ex"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i={START:"start",STOP:"stop"},j=10*1e3;function a(a,b,c,d){d===void 0&&(d=null),this.$5=a,this.$6=b,this.$7=c,this.$1=d,this.$2=!1,this.$3=0,this.$4=null,g(this.destroy.bind(this))}a.prototype.destroy=function(){this.$1&&this.$1.destroy(),this.$1=null,this.$2=!1,this.$3=0,this.$4=null};a.prototype.bootloadPublisherModule=function(a){throw new Error(h("bootloadPublisherModule not implemented, should be overridden by subclass"))};a.prototype.$8=function(a){a=new a(this.$5,this.$6,this.$7);var b=Date.now(),c=this.$3;if(c&&c+j>=b){c=this.$4;c===i.START?a.handleStartEvent():c===i.STOP&&a.handleStopEvent()}this.$1=a};a.prototype.$9=function(){if(this.$2||!this.$5)return;this.$2=!0;this.bootloadPublisherModule(this.$8.bind(this))};a.prototype.attemptPublishStartEvent=function(){this.$4=i.START,this.$3=Date.now(),this.$1?this.$1.handleStartEvent():this.$2||this.$9()};a.prototype.attemptPublishStopEvent=function(){this.$4=i.STOP,this.$3=Date.now(),this.$1?this.$1.handleStopEvent():this.$2||this.$9()};e.exports=a}),null);
__d("MComposerLiveTypingController",["AbstractCommentLiveTypingXHRController","Bootloader"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;b=babelHelpers.inherits(a,g);i=b&&b.prototype;function a(a,b,c){i.constructor.call(this,a,b,c)}a.prototype.bootloadPublisherModule=function(a){h.loadModules(["MComposerLiveTypingPublisher"],a,"MComposerLiveTypingController")};a.prototype.attemptPublishStartEvent=function(){i.attemptPublishStartEvent.call(this)};a.prototype.attemptPublishStopEvent=function(){i.attemptPublishStopEvent.call(this)};e.exports=a}),null);
__d("MCommentComposer",["ChannelClientID","ClientIDs","CommentPrivacyValue","CSS","DOM","MComposerConfig","MComposerLiveTypingController","MLegacyDataStore","MMultiPhotoUploaderAttachmentState","MParent","MUFIInlineRepliesFunnelLogConfig","MViewport","Stratcom","StratcomManager","SubscriptionsHandler","TouchEventType","cancelAnimationFrame","cx","debounceCore","ge","getActiveElement","requestAnimationFrame","requireWeak","setTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){__p&&__p();var F=q.MUFIInlineReplyComposerFunnelLogger,G={logViewerInteracted:function(a){return undefined},logPost:function(a,b){return undefined}};C("MPrivateCommentsLogger",function(a){G=a});var H="m-ufi",I="feed-ufi",J="scroll-area",K="m-composer",L="m-photo-composer",M="m-inline-reply-composer",N="m-noninline-composer",O="textarea",P="privacy-selector",Q="composer-submit",R="inline-reply",S="comment",T=100,U=l.MComposerLoggingController,V=!1;function W(){return!!l.PUBLISH_LIVE}function X(a){if(a.tagName==="FORM")return a;else return k.find(a,"form")}function a(a,b){"use strict";this.$1=a,this.$2=b||{},this.$3=null,this.$4=null,this.$5=!!this.$2.toggle_submit,this.$10=this.$17(),this.$12=o.getDefaultState(),this.$13=!!p.bySigil(a,I),this.$14=!!(this.$2.is_inline_reply&&p.bySigil(this.$1,M)),this.$15=null,this.$2.log_comment&&U&&(this.$15=new U()),this.$8=null,this.$9=!1,this.$7=new u(),this.$18(),s.invoke("marauder-fb-composer-init",null,{parent_fbid:"target_id"in this.$2?this.$2.target_id:-1})}a.prototype.$19=function(){"use strict";this.$8&&this.$8.release(),this.$8=null};a.prototype.destroy=function(){"use strict";this.$7.release(),this.$19(),this.$15&&this.$15.destroy(),this.$15=null,this.$3&&this.$3.destroy(),this.$3=null};a.prototype.$20=function(a){"use strict";__p&&__p();if(!this.$5||!a)return;this.$6&&w(this.$6);this.$6=B(function(){this.$6=null;var b=k.find(a,"*",Q),c=this.$12[o.SENDING]===0&&(!/^\s*$/.test(k.find(a,"*",O).value)||this.$12[o.UPLOADED]>0);!c?b.setAttribute("disabled",!0):b.removeAttribute("disabled");j.conditionClass(b,"_56bt",!c);j.conditionClass(b,"_56bv",c);j.conditionClass(b,"_653w",c)}.bind(this))};a.prototype.$21=function(a){"use strict";a===this.$2.composer_id&&(this.$11=!0,D(function(){this.$11=!1}.bind(this),T))};a.prototype.$22=function(a,b,c){"use strict";if(a===this.$2.composer_id&&b&&c&&this.$2.actor_id!==c){a=k.find(this.$1,"div",K);a=k.scry(a,"div","m-mentions-root")[0];a=a&&n.get(a);a=a||{};a=a.mentionsInstance;a.hasNonEmptyInput()||a.insertMention({name:b,uid:c})}};a.prototype.$23=function(a){"use strict";if(!a||!n.get(a).auto_collapse||!n.get(X(a)).expand_composer)return;var b=k.find(a,"*",O);b=A()===b||!/^\s*$/.test(b.value)||this.$12[o.UPLOADED]>0;if(!b&&this.$11)return;j.conditionClass(a,"composerClosed",!b)};a.prototype.$18=function(){"use strict";__p&&__p();var a=W()?this.$24.bind(this):this.$10.bind(this);this.$16=s.listen(["m:page:render:complete","m:schedulable:loaded"],null,this.$25.bind(this));this.$7.addSubscriptions(s.listen("MCommentComposer:replyButtonClick",null,function(a){return this.$21(a.getData().composerID)}.bind(this)),s.listen("MCommentComposer:replyWithMention",null,function(a){return this.$22(a.getData().composerID,a.getData().replyAuthorName,a.getData().replyAuthorID)}.bind(this)),s.listen("focus",[K,O],this.$26.bind(this)),s.listen("focus",[K,P],this.$27.bind(this)),s.listen("keyup",[K,O],a),s.listen("keydown",[K,O],this.$28.bind(this)),s.listen("input",[K,O],a),s.listen("paste",[K,O],a),s.listen("MMultiPhotoUploader:attachments:change",null,this.$29.bind(this)),s.listen("blur",[K,O],this.$30.bind(this)),s.listen("reset",[K],this.$31.bind(this)),s.listen("touchend",[K,Q],this.$32.bind(this)),s.listen("click",Q,this.$33.bind(this)),s.listen("m:page:unload",null,this.destroy.bind(this)),s.listen("m:feed-ufi-flyout:reset",null,this.$34.bind(this)),this.$10,this.$16);l.CAN_TOUCH_PHOTO_INPUT_WHILE_EXPANDED&&this.$7.addSubscriptions(s.listen("MMultiPhotoUploader:input:click",null,this.$35.bind(this)));this.$14||this.$7.addSubscriptions(s.listen("click","m-add-comment",this.$36.bind(this)));this.$13&&p.bySigil(this.$1,J)&&this.$7.addSubscriptions(s.listen("MScrollArea:scrollstart",null,this.$37.bind(this)));V||(V=!0,t.enableDispatch(window,"reset"));this.$7.addSubscriptions(s.listen("submit",K,this.$38.bind(this)));W()&&this.$7.addSubscriptions(s.listen("m:feed-ufi:hide",null,this.$39.bind(this)));this.$15&&(this.$7.addSubscriptions(s.listen("MMultiPhotoUploader:input:change",null,this.$40.bind(this)),s.listen("m:ufi:iui:comment-added",null,this.$41.bind(this))),this.$14||this.$7.addSubscriptions(s.listen("m:ufi:live-comments:render",null,this.$42.bind(this))));this.$2.is_inline_reply&&F&&this.$7.addSubscriptions(s.listen("m:ufi:sticker-comment",null,this.$43.bind(this)))};a.prototype.$44=function(a){"use strict";return!!a&&k.contains(this.$1,a)};a.prototype.$26=function(event){"use strict";var a=event.getNode(K);if(!this.$44(a))return;var b=k.find(a,"*",O);this.$23(a);n.get(a).disable_auto_scroll||r.scrollToNode(b)};a.prototype.$27=function(event){"use strict";var a=event.getNode(K);if(!a||!this.$44(a))return;j.removeClass(a,"composerClosed")};a.prototype.$17=function(){"use strict";return y(function(event){var a=event.getNode(O);if(!(a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement)||!this.$44(a))return;s.invoke("marauder-feedback-input",null,{draft:a.value});a.form&&G.logViewerInteracted(a.form.id);this.$15&&this.$15.logInitText();this.$20(event.getNode(K))}.bind(this),250)};a.prototype.$24=function(event){"use strict";var a=event.getNode(O);if(!(a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement)||!this.$44(a))return;a=a.value;var b=this.$4;a!==b&&(a&&a.trim().length?this.$45():this.$39());this.$10(event);this.$4=a};a.prototype.$29=function(event){"use strict";__p&&__p();var a=event.getData(),b=z(a.input_id);if(!b)return;b=p.bySigil(b,L);if(!b)return;b=k.find(b,"*",K);if(!this.$44(b))return;this.$12=a;this.$20(b);this.$23(b)};a.prototype.$30=function(event){"use strict";var a=event.getNode(K);if(!this.$44(a))return;this.$9||this.$23(a);this.$9=!1};a.prototype.$31=function(event){"use strict";var a=event.getNode(K);if(!this.$44(a))return;this.$20(a);this.$23(a);this.$39()};a.prototype.$46=function(){"use strict";this.$2.is_inline_reply&&F&&F.logReplySubmitted(this.$2.target_id)};a.prototype.$38=function(event){"use strict";__p&&__p();var a=event.getTarget();if(!a||!this.$44(a))return;var b=k.scry(a,"input","mcomposer-client-id");b.length?b[0].setAttribute("value",h.getNewClientID()):(b=k.create("input",{name:"client_id",sigil:"mcomposer-client-id",type:"hidden",value:h.getNewClientID()}),a.appendChild(b));b=k.scry(a,"input","mcomposer-session-id");b.length||(b=k.create("input",{name:"session_id",sigil:"mcomposer-session-id",type:"hidden",value:g.getID()}),a.appendChild(b));W()&&this.$39();this.$46()};a.prototype.$43=function(event){"use strict";var a=event.getData().textInput;if(!this.$44(a))return;this.$46()};a.prototype.$32=function(event){"use strict";__p&&__p();var a=event.getNode(Q),b=n.get(a);if(a instanceof HTMLElement&&!b.onclickIsSet){var c=event.getNode(K);if(!c||!this.$44(c))return;var d=k.find(c,"*",O);a.onclick=function(){d.blur()};b.onclickIsSet=!0}};a.prototype.$37=function(event){"use strict";__p&&__p();var a=event.getData().element;if(!a||!k.contains(a,this.$1))return;a=k.find(this.$1,"*",K);var b=k.find(a,"*",O);a=k.scry(a,"*","m-mentions-root")[0];a=a&&n.get(a);a=a||{};a=a.mentionsInstance;var c=a&&a.getIgnoreFocusChange();a&&a.setIgnoreFocusChange(!0);b.blur();a&&a.setIgnoreFocusChange(c)};a.prototype.$33=function(event){"use strict";var a=event.getNode(K);if(!this.$44(a))return;a=k.find(a,"*",O);this.$15&&this.$15.logSubmit(a.value.length,this.$12[o.UPLOADED],a.form);G.logPost(parseInt(k.find(a.form,"input","m-comment-privacy").value,10)===i.OWNER_OR_COMMENTER,a.form.id);s.invoke("marauder-feedback-posted",null,{});this.$39()};a.prototype.$36=function(event){"use strict";var a=event.getNode(H);if(!a||!k.contains(a,this.$1))return;a=k.find(this.$1,"*",K);a=k.find(a,"*",O);a.focus()};a.prototype.$34=function(event){"use strict";var a=event.getData();a=a.target_id;this.$13&&a!==this.$2.target_id&&this.destroy()};a.prototype.$47=function(a){"use strict";if(!a)return null;a=p.bySigil(a,L);a=a&&k.scry(a,"*",K)[0];return a&&this.$44(a)?a:null};a.prototype.$35=function(event){"use strict";__p&&__p();var a=A();if(a&&s.hasSigil(a,"textarea")&&this.$44(a)&&p.bySigil(a,L)){this.$9=!0;a.blur();this.$9=!1;this.$19();var b=function(){this.$19();a.blur();var b=k.scry(this.$1,"*",K)[0];b&&this.$23(b)}.bind(this),c=new u();c.addSubscriptions(s.listen("focus",null,b.bind(this)),s.listen(v.START,null,b.bind(this)));this.$8=c}};a.prototype.$40=function(event){"use strict";var a=event.getData();a=a.input;a=this.$47(a);if(!a)return;this.$15&&this.$15.logInitPhoto()};a.prototype.$42=function(event){"use strict";var a=event.getData(),b=a.ufi;a=a.logKeys;if(!b||!a||!k.contains(b,this.$1))return;a.forEach(function(a){return this.$15&&this.$15.logRender(a)}.bind(this))};a.prototype.$41=function(event){"use strict";__p&&__p();var a=event.getData(),b=a.commentNode;a=a.loggingInteractionKey;if(!b||!a)return;var c=s.hasSigil(b,R);if(this.$14&&c){var d=p.bySigil(b.parentNode,S);d=d&&k.scry(d,"*",M)[0]}else if(!c&&!this.$14){d=p.bySigil(b,L);if(!d&&this.$13){c=p.bySigil(b,I);d=k.scry(c,"*",N)[0]}}else return;b=d&&k.scry(d,"*",K)[0];if(!this.$44(b))return;this.$15&&this.$15.logRender(a)};a.prototype.$48=function(){"use strict";this.$2&&this.$2.target_id&&!this.$3&&W()&&(this.$3=new m(this.$2.target_id,this.$2.parent_comment_id,this.$2.actor_id))};a.prototype.$45=function(){"use strict";if(!W())return;this.$48();this.$3&&this.$3.attemptPublishStartEvent()};a.prototype.$39=function(){"use strict";if(!W())return;this.$48();this.$3&&this.$3.attemptPublishStopEvent()};a.prototype.$25=function(){"use strict";this.$2.should_focus&&this.$2.input_id?E(function(){z(this.$2.input_id).focus(),this.$2.is_comments_permalink?r.scrollToTop():z(this.$2.composer_id).scrollIntoView()}.bind(this),0):this.$2.should_anchor&&this.$2.composer_id?z(this.$2.composer_id).scrollIntoView():this.$2.should_anchor_reactions||r.scrollToTop(),this.$16.remove()};a.prototype.$28=function(event){"use strict";if(this.$2.send_with_softkey&&event.getSpecialKey()==="return"){var a=event.getNode(K),b=A();b&&b.blur();k.find(a,"*",Q).click()}};e.exports=a}),null);